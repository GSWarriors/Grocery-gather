"use strict";
/*
 * Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License").
 * You may not use this file except in compliance with the License.
 * A copy of the License is located at
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * or in the "license" file accompanying this file. This file is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.TestAct = exports.DateManagerWithConfirmation = exports.DateManager2 = exports.DateManager = void 0;
const tslib_1 = require("tslib");
const chai_1 = require("chai");
const mocha_1 = require("mocha");
const sinon_1 = tslib_1.__importDefault(require("sinon"));
const DateControl_1 = require("../../src/commonControls/DateControl");
const Strings_1 = require("../../src/constants/Strings");
const ControlManager_1 = require("../../src/controls/ControlManager");
const ControlResult_1 = require("../../src/controls/ControlResult");
const GeneralControlIntent_1 = require("../../src/intents/GeneralControlIntent");
const ControlResponseBuilder_1 = require("../../src/responseGeneration/ControlResponseBuilder");
const ControlHandler_1 = require("../../src/runtime/ControlHandler");
const TestingUtils_1 = require("../../src/utils/testSupport/TestingUtils");
const OrdinalControlIntent_1 = require("../../src/intents/OrdinalControlIntent");
const src_1 = require("../../src");
function dateControlUnderTest() {
    return new DateControl_1.DateControl({
        id: 'dateControl',
        validation: [DateControl_1.DateControlValidations.FUTURE_DATE_ONLY],
        required: true,
        interactionModel: {
            targets: ['food', 'date'],
            actions: {
                set: ['set', 'deliver'],
                change: ['change']
            },
        }
    });
}
function dateControlUnderTest2() {
    return new DateControl_1.DateControl({
        id: 'dateControl2',
        validation: [DateControl_1.DateControlValidations.PAST_DATE_ONLY],
        required: true,
        interactionModel: {
            targets: ['date'],
            actions: {
                set: ['set'],
                change: ['change']
            },
        }
    });
}
class DateManager extends ControlManager_1.ControlManager {
    createControlTree() {
        return dateControlUnderTest();
    }
}
exports.DateManager = DateManager;
class DateManager2 extends ControlManager_1.ControlManager {
    createControlTree() {
        return dateControlUnderTest2();
    }
}
exports.DateManager2 = DateManager2;
class DateManagerWithConfirmation extends ControlManager_1.ControlManager {
    createControlTree() {
        return new DateControl_1.DateControl({
            id: 'dateControlConfirm',
            required: true,
            confirmationRequired: true,
            validation: DateControl_1.DateControlValidations.PAST_DATE_ONLY,
            interactionModel: {
                targets: ['date'],
                actions: {
                    set: ['set'],
                    change: ['change']
                },
            },
            prompts: {
                valueSet: ''
            }
        });
    }
}
exports.DateManagerWithConfirmation = DateManagerWithConfirmation;
class TestAct extends src_1.ContentAct {
    constructor(control, test) {
        super(control);
        this.test = test;
    }
    render(input, responseBuilder) {
        throw new Error('Not implemented.');
    }
}
exports.TestAct = TestAct;
TestingUtils_1.waitForDebugger();
mocha_1.suite('DateControl tests', () => {
    beforeEach(() => {
        // set now to 2019-01-03
        sinon_1.default.useFakeTimers(new Date('2019-01-03T21:55:38.151Z'));
    });
    afterEach(() => {
        sinon_1.default.restore();
    });
    mocha_1.suite('DateControl scenarios', () => {
        const emptyInput = TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({}));
        mocha_1.test('set value with valid date should be processed.', async () => {
            const control = dateControlUnderTest();
            const input = TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { 'AMAZON.DATE': '2020' }));
            const canHandleResult = control.canHandle(input);
            chai_1.expect(canHandleResult).true;
            const result = new ControlResult_1.ControlResultBuilder(undefined);
            await control.handle(input, result);
            chai_1.expect(result.acts).length(1);
            chai_1.expect(result.acts[0]).instanceOf(src_1.ValueSetAct);
            chai_1.expect(result.acts[0].payload.value).eq('2020');
        });
        mocha_1.test('set value with invalid choice should be rejected.', async () => {
            const control = dateControlUnderTest();
            const input = TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { 'action': Strings_1.Strings.Action.Set, 'target': 'food', 'AMAZON.DATE': '2019-01-01' }));
            const canHandleResult = control.canHandle(input);
            chai_1.expect(canHandleResult).true;
            const result = new ControlResult_1.ControlResultBuilder(undefined);
            await control.handle(input, result);
            chai_1.expect(result.acts).length(2);
            chai_1.expect(result.acts[0]).instanceOf(src_1.InvalidValueAct);
            chai_1.expect(result.acts[1]).instanceOf(src_1.RequestValueAct);
        });
        mocha_1.test('change date intent should be handled.', async () => {
            const control = dateControlUnderTest();
            const input = TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ action: Strings_1.Strings.Action.Change, target: 'date' }));
            const canHandleResult = control.canHandle(input);
            chai_1.expect(canHandleResult).true;
            const result = new ControlResult_1.ControlResultBuilder(undefined);
            await control.handle(input, result);
            chai_1.expect(result.acts).length(1);
            chai_1.expect(result.acts[0]).instanceOf(src_1.RequestChangedValueAct);
        });
        mocha_1.test('test controller clear state function.', async () => {
            const control = dateControlUnderTest();
            const input = TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { 'AMAZON.DATE': '2019-01-01' }));
            const canHandleResult = control.canHandle(input);
            chai_1.expect(canHandleResult).true;
            const result = new ControlResult_1.ControlResultBuilder(undefined);
            await control.handle(input, result);
            chai_1.expect(result.acts).length(2);
            chai_1.expect(result.acts[0]).instanceOf(src_1.InvalidValueAct);
            chai_1.expect(result.acts[1]).instanceOf(src_1.RequestValueAct);
            control.clear();
            chai_1.expect(control.state.value).equal(undefined);
        });
        mocha_1.test('test controller renderResultItem throws error for unhandled acts.', async () => {
            const control = dateControlUnderTest();
            const input = TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ action: Strings_1.Strings.Action.Change, target: 'date' }));
            const result = new ControlResponseBuilder_1.ControlResponseBuilder(undefined);
            try {
                control.renderAct(new TestAct(control, 'test'), input, result);
            }
            catch (err) {
                chai_1.expect(err.message).equal('No NLG for TestAct:{"takesInitiative":false,"test":"test","controlId":"dateControl"}');
            }
        });
        mocha_1.test('test controller handle call with invalid canHandle boolean throws error.', async () => {
            const control = dateControlUnderTest();
            const input = TestingUtils_1.TestInput.of(OrdinalControlIntent_1.OrdinalControlIntent.of({}));
            const result = new ControlResult_1.ControlResultBuilder(undefined);
            try {
                await control.handle(input, result);
            }
            catch (err) {
                chai_1.expect(err.message).equal(`${OrdinalControlIntent_1.OrdinalControlIntent.name} can not be handled by ${control.constructor.name}.`);
            }
        });
        mocha_1.test('test controller takeInitiative invokes requestValueAct.', async () => {
            const control = dateControlUnderTest();
            const input = emptyInput;
            const result = new ControlResult_1.ControlResultBuilder(undefined);
            await control.takeInitiative(input, result);
            chai_1.expect(result.acts).length(1);
            chai_1.expect(result.acts[0]).instanceOf(src_1.RequestValueAct);
        });
        mocha_1.test('test controller askElicitationQuestion throws error for invalid action.', async () => {
            const control = dateControlUnderTest();
            const input = emptyInput;
            const result = new ControlResult_1.ControlResultBuilder(undefined);
            try {
                await control.askElicitationQuestion('delete', input, result);
            }
            catch (err) {
                chai_1.expect(err.message).equal('Unhandled. Unknown elicitationAction: delete');
            }
        });
    });
    mocha_1.suite('DateControl e2e tests', () => {
        mocha_1.test('Respond to Alexa\'s question with valid date', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: set', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ action: Strings_1.Strings.Action.Set })),
                'A: What date?',
                'U: 2020', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2020' })),
                'A: OK.',
            ]);
        });
        mocha_1.test('Respond to Alexa\'s question with invalid date', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2018', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2018' })),
                'A: Sorry but that\'s not a valid date because the date cannot be less than today. What date?',
                'U: 2020', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2020-01-01' })),
                'A: OK.'
            ]);
        });
        mocha_1.test('Respond to Alexa\'s question with invalid past date', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager2());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2021', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2021' })),
                'A: Sorry but that\'s not a valid date because the date cannot be greater than today. What date?',
                'U: 2018', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2018' })),
                'A: OK.',
            ]);
        });
        mocha_1.test('Change date with value after setting', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2020', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2020' })),
                'A: OK.',
                'U: change date to 2021', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { 'action': Strings_1.Strings.Action.Change, 'target': 'date', "AMAZON.DATE": '2021' })),
                'A: Changed from 2020 to 2021.',
            ]);
        });
        mocha_1.test('Change date to invalid value after setting', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2020', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2020' })),
                'A: OK.',
                'U: change date to 2016', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { 'action': Strings_1.Strings.Action.Change, 'target': 'date', "AMAZON.DATE": '2016' })),
                'A: Sorry but that\'s not a valid date because the date cannot be less than today. What should I change it to?',
                'U: 2021', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { 'action': Strings_1.Strings.Action.Change, "AMAZON.DATE": '2021' })),
                'A: Changed from 2016 to 2021.',
            ]);
        });
        mocha_1.test('Change date after setting', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2020', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2020' })),
                'A: OK.',
                'U: change', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ action: Strings_1.Strings.Action.Change })),
                'A: What should I change it to?',
                'U: change to 2021', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { 'action': Strings_1.Strings.Action.Change, "AMAZON.DATE": '2021' })),
                'A: Changed from 2020 to 2021.',
            ]);
        });
        mocha_1.test('Change date after setting and later set it to a different value', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 1993', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '1993' })),
                'A: Sorry but that\'s not a valid date because the date cannot be less than today. What date?',
                'U: 2020', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2020' })),
                'A: OK.',
                'U: change', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ action: Strings_1.Strings.Action.Change })),
                'A: What should I change it to?',
                'U: change to 2021', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "action": Strings_1.Strings.Action.Change, "AMAZON.DATE": '2021' })),
                'A: Changed from 2020 to 2021.',
                'U: actually set it to', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ action: Strings_1.Strings.Action.Set })),
                'A: What date?',
                'U: 2025', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2025' })),
                'A: OK.'
            ]);
        });
        mocha_1.test('Change date to invalid value after setting', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManager());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: change', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ action: Strings_1.Strings.Action.Change })),
                'A: What should I change it to?',
                'U: 2018', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2018' })),
                'A: Sorry but that\'s not a valid date because the date cannot be less than today. What should I change it to?',
                'U: 2021', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2021' })),
                'A: Changed from 2018 to 2021.'
            ]);
        });
        mocha_1.test('date valid, needs explicit affirming', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManagerWithConfirmation());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2018', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2018' })),
                'A: Was that 2018?',
                'U: Yeah.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Affirm })),
                'A: Great.'
            ]);
        });
        mocha_1.test('date value after disaffirmation, requires request value act', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManagerWithConfirmation());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2018', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2018' })),
                'A: Was that 2018?',
                'U: No.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Disaffirm })),
                'A: My mistake. What date?'
            ]);
        });
        mocha_1.test('date value set and changing it requires confirmation and value changed act', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManagerWithConfirmation());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2018', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2018' })),
                'A: Was that 2018?',
                'U: Yes.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Affirm })),
                'A: Great.',
                'U: Change to 08-12-1993.', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '08-12-1993', "action": Strings_1.Strings.Action.Change })),
                'A: Was that 08-12-1993?',
                'U: Yes.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Affirm })),
                'A: Great. Changed from 2018 to 08-12-1993.'
            ]);
        });
        mocha_1.test('date value set and changing it to invalid requires confirmation and checks for validations', async () => {
            const requestHandler = new ControlHandler_1.ControlHandler(new DateManagerWithConfirmation());
            await TestingUtils_1.testE2E(requestHandler, [
                'U: 2018', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2018' })),
                'A: Was that 2018?',
                'U: Yes.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Affirm })),
                'A: Great.',
                'U: Change to 2021.', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2021', "action": Strings_1.Strings.Action.Change })),
                'A: Was that 2021?',
                'U: Yes.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Affirm })),
                'A: Sorry but that\'s not a valid date because the date cannot be greater than today. What should I change it to?',
                'U: 2000.', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2000' })),
                'A: Was that 2000?',
                'U: No.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Disaffirm })),
                'A: My mistake. What date?',
                'U: 2016.', TestingUtils_1.TestInput.of(src_1.SingleValueControlIntent.of(src_1.AmazonBuiltInSlotType.DATE, { "AMAZON.DATE": '2016' })),
                'A: Was that 2016?',
                'U: Yes.', TestingUtils_1.TestInput.of(GeneralControlIntent_1.GeneralControlIntent.of({ feedback: Strings_1.Strings.Feedback.Affirm })),
                'A: Great. Changed from 2000 to 2016.'
            ]);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF0ZUNvbnRyb2wuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Rlc3QvY29tbW9uQ29udHJvbFRlc3RzL0RhdGVDb250cm9sLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7OztHQVdHOzs7O0FBRUgsK0JBQThCO0FBQzlCLGlDQUFvQztBQUNwQywwREFBMEI7QUFDMUIsc0VBQTJGO0FBQzNGLHlEQUEyRDtBQUUzRCxzRUFBbUU7QUFDbkUsb0VBQXdFO0FBQ3hFLGlGQUE4RTtBQUM5RSxnR0FBNkY7QUFDN0YscUVBQWtFO0FBQ2xFLDJFQUErRjtBQUMvRixpRkFBOEU7QUFDOUUsbUNBQTZLO0FBRTdLLFNBQVMsb0JBQW9CO0lBQ3pCLE9BQU8sSUFBSSx5QkFBVyxDQUFDO1FBQ25CLEVBQUUsRUFBRSxhQUFhO1FBQ2pCLFVBQVUsRUFBRSxDQUFDLG9DQUFzQixDQUFDLGdCQUFnQixDQUFDO1FBQ3JELFFBQVEsRUFBRSxJQUFJO1FBQ2QsZ0JBQWdCLEVBQUU7WUFDZCxPQUFPLEVBQUUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDO1lBQ3pCLE9BQU8sRUFBRTtnQkFDTCxHQUFHLEVBQUUsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDO2dCQUN2QixNQUFNLEVBQUUsQ0FBQyxRQUFRLENBQUM7YUFDckI7U0FDSjtLQUNKLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRCxTQUFTLHFCQUFxQjtJQUMxQixPQUFPLElBQUkseUJBQVcsQ0FBQztRQUNuQixFQUFFLEVBQUUsY0FBYztRQUNsQixVQUFVLEVBQUUsQ0FBQyxvQ0FBc0IsQ0FBQyxjQUFjLENBQUM7UUFDbkQsUUFBUSxFQUFFLElBQUk7UUFDZCxnQkFBZ0IsRUFBRTtZQUNkLE9BQU8sRUFBRSxDQUFDLE1BQU0sQ0FBQztZQUNqQixPQUFPLEVBQUU7Z0JBQ0wsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDO2dCQUNaLE1BQU0sRUFBRSxDQUFDLFFB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QixDQUFDLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxpQkFBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO2dCQUNqRixrSEFBa0g7Z0JBQ2xILFVBQVUsRUFBRSx3QkFBUyxDQUFDLEVBQUUsQ0FBQyw4QkFBd0IsQ0FBQyxFQUFFLENBQUMsMkJBQXFCLENBQUMsSUFBSSxFQUFFLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBQyxDQUFDLENBQUM7Z0JBQzNHLG1CQUFtQjtnQkFDbkIsUUFBUSxFQUFFLHdCQUFTLENBQUMsRUFBRSxDQUFDLDJDQUFvQixDQUFDLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxpQkFBQyxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDO2dCQUNuRiwyQkFBMkI7Z0JBQzNCLFVBQVUsRUFBRSx3QkFBUyxDQUFDLEVBQUUsQ0FBQyw4QkFBd0IsQ0FBQyxFQUFFLENBQUMsMkJBQXFCLENBQUMsSUFBSSxFQUFFLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBQyxDQUFDLENBQUM7Z0JBQzNHLG1CQUFtQjtnQkFDbkIsU0FBUyxFQUFFLHdCQUFTLENBQUMsRUFBRSxDQUFDLDJDQUFvQixDQUFDLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxpQkFBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO2dCQUNqRixzQ0FBc0M7YUFDekMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAyMDE5IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLlxuICogWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkXG4gKiBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXJcbiAqIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nXG4gKiBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgZXhwZWN0IH0gZnJvbSAnY2hhaSc7XG5pbXBvcnQgeyBzdWl0ZSwgdGVzdCB9IGZyb20gXCJtb2NoYVwiO1xuaW1wb3J0IHNpbm9uIGZyb20gJ3Npbm9uJztcbmltcG9ydCB7IERhdGVDb250cm9sLCBEYXRlQ29udHJvbFZhbGlkYXRpb25zIH0gZnJvbSAnLi4vLi4vc3JjL2NvbW1vbkNvbnRyb2xzL0RhdGVDb250cm9sJztcbmltcG9ydCB7IFN0cmluZ3MgYXMgJCB9IGZyb20gXCIuLi8uLi9zcmMvY29uc3RhbnRzL1N0cmluZ3NcIjtcbmltcG9ydCB7IENvbnRyb2wgfSBmcm9tICcuLi8uLi9zcmMvY29udHJvbHMvQ29udHJvbCc7XG5pbXBvcnQgeyBDb250cm9sTWFuYWdlciB9IGZyb20gJy4uLy4uL3NyYy9jb250cm9scy9Db250cm9sTWFuYWdlcic7XG5pbXBvcnQgeyBDb250cm9sUmVzdWx0QnVpbGRlciB9IGZyb20gJy4uLy4uL3NyYy9jb250cm9scy9Db250cm9sUmVzdWx0JztcbmltcG9ydCB7IEdlbmVyYWxDb250cm9sSW50ZW50IH0gZnJvbSAnLi4vLi4vc3JjL2ludGVudHMvR2VuZXJhbENvbnRyb2xJbnRlbnQnO1xuaW1wb3J0IHsgQ29udHJvbFJlc3BvbnNlQnVpbGRlciB9IGZyb20gJy4uLy4uL3NyYy9yZXNwb25zZUdlbmVyYXRpb24vQ29udHJvbFJlc3BvbnNlQnVpbGRlcic7XG5pbXBvcnQgeyBDb250cm9sSGFuZGxlciB9IGZyb20gJy4uLy4uL3NyYy9ydW50aW1lL0NvbnRyb2xIYW5kbGVyJztcbmltcG9ydCB7IHRlc3RFMkUsIFRlc3RJbnB1dCwgd2FpdEZvckRlYnVnZ2VyIH0gZnJvbSAnLi4vLi4vc3JjL3V0aWxzL3Rlc3RTdXBwb3J0L1Rlc3RpbmdVdGlscyc7XG5pbXBvcnQgeyBPcmRpbmFsQ29udHJvbEludGVudCB9IGZyb20gJy4uLy4uL3NyYy9pbnRlbnRzL09yZGluYWxDb250cm9sSW50ZW50JztcbmltcG9ydCB7IENvbnRlbnRBY3QsIENvbnRyb2xJbnB1dCwgU2luZ2xlVmFsdWVDb250cm9sSW50ZW50LCBBbWF6b25CdWlsdEluU2xvdFR5cGUsIFZhbHVlU2V0QWN0LCBJbnZhbGlkVmFsdWVBY3QsIFJlcXVlc3RWYWx1ZUFjdCwgUmVxdWVzdENoYW5nZWRWYWx1ZUFjdCB9IGZyb20gJy4uLy4uL3NyYyc7XG5cbmZ1bmN0aW9uIGRhdGVDb250cm9sVW5kZXJUZXN0KCk6IERhdGVDb250cm9sIHtcbiAgICByZXR1cm4gbmV3IERhdGVDb250cm9sKHtcbiAgICAgICAgaWQ6ICdkYXRlQ29udHJvbCcsXG4gICAgICAgIHZhbGlkYXRpb246IFtEYXRlQ29udHJvbFZhbGlkYXRpb25zLkZVVFVSRV9EQVRFX09OTFldLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgaW50ZXJhY3Rpb25Nb2RlbDoge1xuICAgICAgICAgICAgdGFyZ2V0czogWydmb29kJywgJ2RhdGUnXSxcbiAgICAgICAgICAgIGFjdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBzZXQ6IFsnc2V0JywgJ2RlbGl2ZXInXSxcbiAgICAgICAgICAgICAgICBjaGFuZ2U6IFsnY2hhbmdlJ11cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZGF0ZUNvbnRyb2xVbmRlclRlc3QyKCk6IERhdGVDb250cm9sIHtcbiAgICByZXR1cm4gbmV3IERhdGVDb250cm9sKHtcbiAgICAgICAgaWQ6ICdkYXRlQ29udHJvbDInLFxuICAgICAgICB2YWxpZGF0aW9uOiBbRGF0ZUNvbnRyb2xWYWxpZGF0aW9ucy5QQVNUX0RBVEVfT05MWV0sXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICBpbnRlcmFjdGlvbk1vZGVsOiB7XG4gICAgICAgICAgICB0YXJnZXRzOiBbJ2RhdGUnXSxcbiAgICAgICAgICAgIGFjdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBzZXQ6IFsnc2V0J10sXG4gICAgICAgICAgICAgICAgY2hhbmdlOiBbJ2NoYW5nZSddXG4gICAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmV4cG9ydCBjbGFzcyBEYXRlTWFuYWdlciBleHRlbmRzIENvbnRyb2xNYW5hZ2VyIHtcbiAgICBjcmVhdGVDb250cm9sVHJlZSgpOiBDb250cm9sIHtcbiAgICAgICAgcmV0dXJuIGRhdGVDb250cm9sVW5kZXJUZXN0KCk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRGF0ZU1hbmFnZXIyIGV4dGVuZHMgQ29udHJvbE1hbmFnZXIge1xuICAgIGNyZWF0ZUNvbnRyb2xUcmVlKCk6IENvbnRyb2wge1xuICAgICAgICByZXR1cm4gZGF0ZUNvbnRyb2xVbmRlclRlc3QyKCk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRGF0ZU1hbmFnZXJXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgQ29udHJvbE1hbmFnZXIge1xuICAgIGNyZWF0ZUNvbnRyb2xUcmVlKCk6IENvbnRyb2wge1xuICAgICAgICByZXR1cm4gbmV3IERhdGVDb250cm9sKHtcbiAgICAgICAgICAgIGlkOiAnZGF0ZUNvbnRyb2xDb25maXJtJyxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlybWF0aW9uUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICB2YWxpZGF0aW9uOiBEYXRlQ29udHJvbFZhbGlkYXRpb25zLlBBU1RfREFURV9PTkxZLFxuICAgICAgICAgICAgaW50ZXJhY3Rpb25Nb2RlbDoge1xuICAgICAgICAgICAgICAgIHRhcmdldHM6IFsnZGF0ZSddLFxuICAgICAgICAgICAgICAgIGFjdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0OiBbJ3NldCddLFxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IFsnY2hhbmdlJ11cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHByb21wdHM6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZVNldDogJydcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgVGVzdEFjdCBleHRlbmRzIENvbnRlbnRBY3Qge1xuICAgIHRlc3Q/OiBzdHJpbmc7XG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCwgdGVzdDogc3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKGNvbnRyb2wpO1xuICAgICAgICB0aGlzLnRlc3QgPSB0ZXN0O1xuICAgIH1cbiAgICByZW5kZXIoaW5wdXQ6IENvbnRyb2xJbnB1dCwgcmVzcG9uc2VCdWlsZGVyOiBDb250cm9sUmVzcG9uc2VCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm90IGltcGxlbWVudGVkLicpO1xuICAgIH1cbn1cblxud2FpdEZvckRlYnVnZ2VyKCk7XG5cbnN1aXRlKCdEYXRlQ29udHJvbCB0ZXN0cycsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgLy8gc2V0IG5vdyB0byAyMDE5LTAxLTAzXG4gICAgICAgIHNpbm9uLnVzZUZha2VUaW1lcnMobmV3IERhdGUoJzIwMTktMDEtMDNUMjE6NTU6MzguMTUxWicpKTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICAgIHNpbm9uLnJlc3RvcmUoKTtcbiAgICB9KTtcblxuICAgIHN1aXRlKCdEYXRlQ29udHJvbCBzY2VuYXJpb3MnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGVtcHR5SW5wdXQgPSBUZXN0SW5wdXQub2YoR2VuZXJhbENvbnRyb2xJbnRlbnQub2Yoe30pKTtcblxuICAgICAgICB0ZXN0KCdzZXQgdmFsdWUgd2l0aCB2YWxpZCBkYXRlIHNob3VsZCBiZSBwcm9jZXNzZWQuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udHJvbCA9IGRhdGVDb250cm9sVW5kZXJUZXN0KCk7XG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsnQU1BWk9OLkRBVEUnOiAnMjAyMCcgfSkpO1xuICAgICAgICAgICAgY29uc3QgY2FuSGFuZGxlUmVzdWx0ID0gY29udHJvbC5jYW5IYW5kbGUoaW5wdXQpO1xuICAgICAgICAgICAgZXhwZWN0KGNhbkhhbmRsZVJlc3VsdCkudHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBDb250cm9sUmVzdWx0QnVpbGRlcih1bmRlZmluZWQhKTtcbiAgICAgICAgICAgIGF3YWl0IGNvbnRyb2wuaGFuZGxlKGlucHV0LCByZXN1bHQpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmFjdHMpLmxlbmd0aCgxKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuYWN0c1swXSkuaW5zdGFuY2VPZihWYWx1ZVNldEFjdCk7XG4gICAgICAgICAgICBleHBlY3QoKHJlc3VsdC5hY3RzWzBdIGFzIFZhbHVlU2V0QWN0PGFueT4pLnBheWxvYWQudmFsdWUpLmVxKCcyMDIwJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3NldCB2YWx1ZSB3aXRoIGludmFsaWQgY2hvaWNlIHNob3VsZCBiZSByZWplY3RlZC4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sID0gZGF0ZUNvbnRyb2xVbmRlclRlc3QoKTtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyAnYWN0aW9uJzogJC5BY3Rpb24uU2V0LCAndGFyZ2V0JzogJ2Zvb2QnLCAnQU1BWk9OLkRBVEUnOiAnMjAxOS0wMS0wMScgfSkpO1xuICAgICAgICAgICAgY29uc3QgY2FuSGFuZGxlUmVzdWx0ID0gY29udHJvbC5jYW5IYW5kbGUoaW5wdXQpO1xuICAgICAgICAgICAgZXhwZWN0KGNhbkhhbmRsZVJlc3VsdCkudHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBDb250cm9sUmVzdWx0QnVpbGRlcih1bmRlZmluZWQhKTtcbiAgICAgICAgICAgIGF3YWl0IGNvbnRyb2wuaGFuZGxlKGlucHV0LCByZXN1bHQpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmFjdHMpLmxlbmd0aCgyKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuYWN0c1swXSkuaW5zdGFuY2VPZihJbnZhbGlkVmFsdWVBY3QpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5hY3RzWzFdKS5pbnN0YW5jZU9mKFJlcXVlc3RWYWx1ZUFjdCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ2NoYW5nZSBkYXRlIGludGVudCBzaG91bGQgYmUgaGFuZGxlZC4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sID0gZGF0ZUNvbnRyb2xVbmRlclRlc3QoKTtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gVGVzdElucHV0Lm9mKEdlbmVyYWxDb250cm9sSW50ZW50Lm9mKHsgYWN0aW9uOiAkLkFjdGlvbi5DaGFuZ2UsIHRhcmdldDogJ2RhdGUnIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IGNhbkhhbmRsZVJlc3VsdCA9IGNvbnRyb2wuY2FuSGFuZGxlKGlucHV0KTtcbiAgICAgICAgICAgIGV4cGVjdChjYW5IYW5kbGVSZXN1bHQpLnRydWU7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgQ29udHJvbFJlc3VsdEJ1aWxkZXIodW5kZWZpbmVkISk7XG4gICAgICAgICAgICBhd2FpdCBjb250cm9sLmhhbmRsZShpbnB1dCwgcmVzdWx0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5hY3RzKS5sZW5ndGgoMSk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmFjdHNbMF0pLmluc3RhbmNlT2YoUmVxdWVzdENoYW5nZWRWYWx1ZUFjdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0ZXN0KCd0ZXN0IGNvbnRyb2xsZXIgY2xlYXIgc3RhdGUgZnVuY3Rpb24uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udHJvbCA9IGRhdGVDb250cm9sVW5kZXJUZXN0KCk7XG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsnQU1BWk9OLkRBVEUnOiAnMjAxOS0wMS0wMScgfSkpO1xuICAgICAgICAgICAgY29uc3QgY2FuSGFuZGxlUmVzdWx0ID0gY29udHJvbC5jYW5IYW5kbGUoaW5wdXQpO1xuICAgICAgICAgICAgZXhwZWN0KGNhbkhhbmRsZVJlc3VsdCkudHJ1ZTtcblxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IENvbnRyb2xSZXN1bHRCdWlsZGVyKHVuZGVmaW5lZCEpO1xuICAgICAgICAgICAgYXdhaXQgY29udHJvbC5oYW5kbGUoaW5wdXQsIHJlc3VsdCk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmFjdHMpLmxlbmd0aCgyKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuYWN0c1swXSkuaW5zdGFuY2VPZihJbnZhbGlkVmFsdWVBY3QpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5hY3RzWzFdKS5pbnN0YW5jZU9mKFJlcXVlc3RWYWx1ZUFjdCk7XG5cbiAgICAgICAgICAgIGNvbnRyb2wuY2xlYXIoKTtcbiAgICAgICAgICAgIGV4cGVjdChjb250cm9sLnN0YXRlLnZhbHVlKS5lcXVhbCh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCd0ZXN0IGNvbnRyb2xsZXIgcmVuZGVyUmVzdWx0SXRlbSB0aHJvd3MgZXJyb3IgZm9yIHVuaGFuZGxlZCBhY3RzLicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2wgPSBkYXRlQ29udHJvbFVuZGVyVGVzdCgpO1xuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBUZXN0SW5wdXQub2YoR2VuZXJhbENvbnRyb2xJbnRlbnQub2YoeyBhY3Rpb246ICQuQWN0aW9uLkNoYW5nZSwgdGFyZ2V0OiAnZGF0ZScgfSkpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IENvbnRyb2xSZXNwb25zZUJ1aWxkZXIodW5kZWZpbmVkISk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2wucmVuZGVyQWN0KG5ldyBUZXN0QWN0KGNvbnRyb2wsICd0ZXN0JyksIGlucHV0LCByZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIGV4cGVjdChlcnIubWVzc2FnZSkuZXF1YWwoJ05vIE5MRyBmb3IgVGVzdEFjdDp7XCJ0YWtlc0luaXRpYXRpdmVcIjpmYWxzZSxcInRlc3RcIjpcInRlc3RcIixcImNvbnRyb2xJZFwiOlwiZGF0ZUNvbnRyb2xcIn0nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgndGVzdCBjb250cm9sbGVyIGhhbmRsZSBjYWxsIHdpdGggaW52YWxpZCBjYW5IYW5kbGUgYm9vbGVhbiB0aHJvd3MgZXJyb3IuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udHJvbCA9IGRhdGVDb250cm9sVW5kZXJUZXN0KCk7XG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IFRlc3RJbnB1dC5vZihPcmRpbmFsQ29udHJvbEludGVudC5vZih7fSkpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IENvbnRyb2xSZXN1bHRCdWlsZGVyKHVuZGVmaW5lZCEpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBjb250cm9sLmhhbmRsZShpbnB1dCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBleHBlY3QoZXJyLm1lc3NhZ2UpLmVxdWFsKGAke09yZGluYWxDb250cm9sSW50ZW50Lm5hbWV9IGNhbiBub3QgYmUgaGFuZGxlZCBieSAke2NvbnRyb2wuY29uc3RydWN0b3IubmFtZX0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Rlc3QgY29udHJvbGxlciB0YWtlSW5pdGlhdGl2ZSBpbnZva2VzIHJlcXVlc3RWYWx1ZUFjdC4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sID0gZGF0ZUNvbnRyb2xVbmRlclRlc3QoKTtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZW1wdHlJbnB1dDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBDb250cm9sUmVzdWx0QnVpbGRlcih1bmRlZmluZWQhKTtcbiAgICAgICAgICAgIGF3YWl0IGNvbnRyb2wudGFrZUluaXRpYXRpdmUoaW5wdXQsIHJlc3VsdCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuYWN0cykubGVuZ3RoKDEpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5hY3RzWzBdKS5pbnN0YW5jZU9mKFJlcXVlc3RWYWx1ZUFjdCk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgndGVzdCBjb250cm9sbGVyIGFza0VsaWNpdGF0aW9uUXVlc3Rpb24gdGhyb3dzIGVycm9yIGZvciBpbnZhbGlkIGFjdGlvbi4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sID0gZGF0ZUNvbnRyb2xVbmRlclRlc3QoKTtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZW1wdHlJbnB1dDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBDb250cm9sUmVzdWx0QnVpbGRlcih1bmRlZmluZWQhKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgY29udHJvbC5hc2tFbGljaXRhdGlvblF1ZXN0aW9uKCdkZWxldGUnLCBpbnB1dCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBleHBlY3QoZXJyLm1lc3NhZ2UpLmVxdWFsKCdVbmhhbmRsZWQuIFVua25vd24gZWxpY2l0YXRpb25BY3Rpb246IGRlbGV0ZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgc3VpdGUoJ0RhdGVDb250cm9sIGUyZSB0ZXN0cycsICgpID0+IHtcbiAgICAgICAgdGVzdCgnUmVzcG9uZCB0byBBbGV4YVxcJ3MgcXVlc3Rpb24gd2l0aCB2YWxpZCBkYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdEhhbmRsZXIgPSBuZXcgQ29udHJvbEhhbmRsZXIobmV3IERhdGVNYW5hZ2VyKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGVzdEUyRShyZXF1ZXN0SGFuZGxlciwgW1xuICAgICAgICAgICAgICAgICdVOiBzZXQnLCBUZXN0SW5wdXQub2YoR2VuZXJhbENvbnRyb2xJbnRlbnQub2YoeyBhY3Rpb246ICQuQWN0aW9uLlNldCB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdoYXQgZGF0ZT8nLFxuICAgICAgICAgICAgICAgICdVOiAyMDIwJywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyBcIkFNQVpPTi5EQVRFXCI6ICcyMDIwJyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IE9LLicsXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnUmVzcG9uZCB0byBBbGV4YVxcJ3MgcXVlc3Rpb24gd2l0aCBpbnZhbGlkIGRhdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IG5ldyBDb250cm9sSGFuZGxlcihuZXcgRGF0ZU1hbmFnZXIoKSk7XG4gICAgICAgICAgICBhd2FpdCB0ZXN0RTJFKHJlcXVlc3RIYW5kbGVyLCBbXG4gICAgICAgICAgICAgICAgJ1U6IDIwMTgnLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7IFwiQU1BWk9OLkRBVEVcIjogJzIwMTgnIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogU29ycnkgYnV0IHRoYXRcXCdzIG5vdCBhIHZhbGlkIGRhdGUgYmVjYXVzZSB0aGUgZGF0ZSBjYW5ub3QgYmUgbGVzcyB0aGFuIHRvZGF5LiBXaGF0IGRhdGU/JyxcbiAgICAgICAgICAgICAgICAnVTogMjAyMCcsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJBTUFaT04uREFURVwiOiAnMjAyMC0wMS0wMScgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBPSy4nXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnUmVzcG9uZCB0byBBbGV4YVxcJ3MgcXVlc3Rpb24gd2l0aCBpbnZhbGlkIHBhc3QgZGF0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RIYW5kbGVyID0gbmV3IENvbnRyb2xIYW5kbGVyKG5ldyBEYXRlTWFuYWdlcjIoKSk7XG4gICAgICAgICAgICBhd2FpdCB0ZXN0RTJFKHJlcXVlc3RIYW5kbGVyLCBbXG4gICAgICAgICAgICAgICAgJ1U6IDIwMjEnLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7IFwiQU1BWk9OLkRBVEVcIjogJzIwMjEnIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogU29ycnkgYnV0IHRoYXRcXCdzIG5vdCBhIHZhbGlkIGRhdGUgYmVjYXVzZSB0aGUgZGF0ZSBjYW5ub3QgYmUgZ3JlYXRlciB0aGFuIHRvZGF5LiBXaGF0IGRhdGU/JyxcbiAgICAgICAgICAgICAgICAnVTogMjAxOCcsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJBTUFaT04uREFURVwiOiAnMjAxOCcgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBPSy4nLFxuICAgICAgICAgICAgXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ0NoYW5nZSBkYXRlIHdpdGggdmFsdWUgYWZ0ZXIgc2V0dGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RIYW5kbGVyID0gbmV3IENvbnRyb2xIYW5kbGVyKG5ldyBEYXRlTWFuYWdlcigpKTtcbiAgICAgICAgICAgIGF3YWl0IHRlc3RFMkUocmVxdWVzdEhhbmRsZXIsIFtcbiAgICAgICAgICAgICAgICAnVTogMjAyMCcsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJBTUFaT04uREFURVwiOiAnMjAyMCcgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBPSy4nLFxuICAgICAgICAgICAgICAgICdVOiBjaGFuZ2UgZGF0ZSB0byAyMDIxJywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyAnYWN0aW9uJzogJC5BY3Rpb24uQ2hhbmdlLCAndGFyZ2V0JzogJ2RhdGUnLCBcIkFNQVpPTi5EQVRFXCI6ICcyMDIxJyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IENoYW5nZWQgZnJvbSAyMDIwIHRvIDIwMjEuJyxcbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdDaGFuZ2UgZGF0ZSB0byBpbnZhbGlkIHZhbHVlIGFmdGVyIHNldHRpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IG5ldyBDb250cm9sSGFuZGxlcihuZXcgRGF0ZU1hbmFnZXIoKSk7XG4gICAgICAgICAgICBhd2FpdCB0ZXN0RTJFKHJlcXVlc3RIYW5kbGVyLCBbXG4gICAgICAgICAgICAgICAgJ1U6IDIwMjAnLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7IFwiQU1BWk9OLkRBVEVcIjogJzIwMjAnIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogT0suJyxcbiAgICAgICAgICAgICAgICAnVTogY2hhbmdlIGRhdGUgdG8gMjAxNicsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgJ2FjdGlvbic6ICQuQWN0aW9uLkNoYW5nZSwgJ3RhcmdldCc6ICdkYXRlJywgXCJBTUFaT04uREFURVwiOiAnMjAxNicgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBTb3JyeSBidXQgdGhhdFxcJ3Mgbm90IGEgdmFsaWQgZGF0ZSBiZWNhdXNlIHRoZSBkYXRlIGNhbm5vdCBiZSBsZXNzIHRoYW4gdG9kYXkuIFdoYXQgc2hvdWxkIEkgY2hhbmdlIGl0IHRvPycsXG4gICAgICAgICAgICAgICAgJ1U6IDIwMjEnLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7ICdhY3Rpb24nOiAkLkFjdGlvbi5DaGFuZ2UsIFwiQU1BWk9OLkRBVEVcIjogJzIwMjEnIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogQ2hhbmdlZCBmcm9tIDIwMTYgdG8gMjAyMS4nLFxuICAgICAgICAgICAgXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ0NoYW5nZSBkYXRlIGFmdGVyIHNldHRpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IG5ldyBDb250cm9sSGFuZGxlcihuZXcgRGF0ZU1hbmFnZXIoKSk7XG4gICAgICAgICAgICBhd2FpdCB0ZXN0RTJFKHJlcXVlc3RIYW5kbGVyLCBbXG4gICAgICAgICAgICAgICAgJ1U6IDIwMjAnLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7IFwiQU1BWk9OLkRBVEVcIjogJzIwMjAnIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogT0suJyxcbiAgICAgICAgICAgICAgICAnVTogY2hhbmdlJywgVGVzdElucHV0Lm9mKEdlbmVyYWxDb250cm9sSW50ZW50Lm9mKHsgYWN0aW9uOiAkLkFjdGlvbi5DaGFuZ2UgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBXaGF0IHNob3VsZCBJIGNoYW5nZSBpdCB0bz8nLFxuICAgICAgICAgICAgICAgICdVOiBjaGFuZ2UgdG8gMjAyMScsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgJ2FjdGlvbic6ICQuQWN0aW9uLkNoYW5nZSwgXCJBTUFaT04uREFURVwiOiAnMjAyMScgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBDaGFuZ2VkIGZyb20gMjAyMCB0byAyMDIxLicsXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnQ2hhbmdlIGRhdGUgYWZ0ZXIgc2V0dGluZyBhbmQgbGF0ZXIgc2V0IGl0IHRvIGEgZGlmZmVyZW50IHZhbHVlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdEhhbmRsZXIgPSBuZXcgQ29udHJvbEhhbmRsZXIobmV3IERhdGVNYW5hZ2VyKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGVzdEUyRShyZXF1ZXN0SGFuZGxlciwgW1xuICAgICAgICAgICAgICAgICdVOiAxOTkzJywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyBcIkFNQVpPTi5EQVRFXCI6ICcxOTkzJyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFNvcnJ5IGJ1dCB0aGF0XFwncyBub3QgYSB2YWxpZCBkYXRlIGJlY2F1c2UgdGhlIGRhdGUgY2Fubm90IGJlIGxlc3MgdGhhbiB0b2RheS4gV2hhdCBkYXRlPycsXG4gICAgICAgICAgICAgICAgJ1U6IDIwMjAnLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7IFwiQU1BWk9OLkRBVEVcIjogJzIwMjAnIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogT0suJyxcbiAgICAgICAgICAgICAgICAnVTogY2hhbmdlJywgVGVzdElucHV0Lm9mKEdlbmVyYWxDb250cm9sSW50ZW50Lm9mKHsgYWN0aW9uOiAkLkFjdGlvbi5DaGFuZ2UgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBXaGF0IHNob3VsZCBJIGNoYW5nZSBpdCB0bz8nLFxuICAgICAgICAgICAgICAgICdVOiBjaGFuZ2UgdG8gMjAyMScsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJhY3Rpb25cIjogJC5BY3Rpb24uQ2hhbmdlLCBcIkFNQVpPTi5EQVRFXCI6ICcyMDIxJyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IENoYW5nZWQgZnJvbSAyMDIwIHRvIDIwMjEuJyxcbiAgICAgICAgICAgICAgICAnVTogYWN0dWFsbHkgc2V0IGl0IHRvJywgVGVzdElucHV0Lm9mKEdlbmVyYWxDb250cm9sSW50ZW50Lm9mKHthY3Rpb246ICQuQWN0aW9uLlNldH0pKSxcbiAgICAgICAgICAgICAgICAnQTogV2hhdCBkYXRlPycsXG4gICAgICAgICAgICAgICAgJ1U6IDIwMjUnLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7IFwiQU1BWk9OLkRBVEVcIjogJzIwMjUnIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogT0suJ1xuICAgICAgICAgICAgXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ0NoYW5nZSBkYXRlIHRvIGludmFsaWQgdmFsdWUgYWZ0ZXIgc2V0dGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RIYW5kbGVyID0gbmV3IENvbnRyb2xIYW5kbGVyKG5ldyBEYXRlTWFuYWdlcigpKTtcbiAgICAgICAgICAgIGF3YWl0IHRlc3RFMkUocmVxdWVzdEhhbmRsZXIsIFtcbiAgICAgICAgICAgICAgICAnVTogY2hhbmdlJywgVGVzdElucHV0Lm9mKEdlbmVyYWxDb250cm9sSW50ZW50Lm9mKHsgYWN0aW9uOiAkLkFjdGlvbi5DaGFuZ2UgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBXaGF0IHNob3VsZCBJIGNoYW5nZSBpdCB0bz8nLFxuICAgICAgICAgICAgICAgICdVOiAyMDE4JywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyBcIkFNQVpPTi5EQVRFXCI6ICcyMDE4JyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFNvcnJ5IGJ1dCB0aGF0XFwncyBub3QgYSB2YWxpZCBkYXRlIGJlY2F1c2UgdGhlIGRhdGUgY2Fubm90IGJlIGxlc3MgdGhhbiB0b2RheS4gV2hhdCBzaG91bGQgSSBjaGFuZ2UgaXQgdG8/JyxcbiAgICAgICAgICAgICAgICAnVTogMjAyMScsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJBTUFaT04uREFURVwiOiAnMjAyMScgfSkpLFxuICAgICAgICAgICAgICAgICdBOiBDaGFuZ2VkIGZyb20gMjAxOCB0byAyMDIxLidcbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdkYXRlIHZhbGlkLCBuZWVkcyBleHBsaWNpdCBhZmZpcm1pbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IG5ldyBDb250cm9sSGFuZGxlcihuZXcgRGF0ZU1hbmFnZXJXaXRoQ29uZmlybWF0aW9uKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGVzdEUyRShyZXF1ZXN0SGFuZGxlciwgW1xuICAgICAgICAgICAgICAgICdVOiAyMDE4JywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyBcIkFNQVpPTi5EQVRFXCI6ICcyMDE4JyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdhcyB0aGF0IDIwMTg/JyxcbiAgICAgICAgICAgICAgICAnVTogWWVhaC4nLCBUZXN0SW5wdXQub2YoR2VuZXJhbENvbnRyb2xJbnRlbnQub2YoeyBmZWVkYmFjazogJC5GZWVkYmFjay5BZmZpcm0gfSkpLFxuICAgICAgICAgICAgICAgICdBOiBHcmVhdC4nXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnZGF0ZSB2YWx1ZSBhZnRlciBkaXNhZmZpcm1hdGlvbiwgcmVxdWlyZXMgcmVxdWVzdCB2YWx1ZSBhY3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IG5ldyBDb250cm9sSGFuZGxlcihuZXcgRGF0ZU1hbmFnZXJXaXRoQ29uZmlybWF0aW9uKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGVzdEUyRShyZXF1ZXN0SGFuZGxlciwgW1xuICAgICAgICAgICAgICAgICdVOiAyMDE4JywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyBcIkFNQVpPTi5EQVRFXCI6ICcyMDE4JyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdhcyB0aGF0IDIwMTg/JyxcbiAgICAgICAgICAgICAgICAnVTogTm8uJywgVGVzdElucHV0Lm9mKEdlbmVyYWxDb250cm9sSW50ZW50Lm9mKHsgZmVlZGJhY2s6ICQuRmVlZGJhY2suRGlzYWZmaXJtIH0pKSxcbiAgICAgICAgICAgICAgICAnQTogTXkgbWlzdGFrZS4gV2hhdCBkYXRlPydcbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9KTtcbiAgICBcbiAgICAgICAgdGVzdCgnZGF0ZSB2YWx1ZSBzZXQgYW5kIGNoYW5naW5nIGl0IHJlcXVpcmVzIGNvbmZpcm1hdGlvbiBhbmQgdmFsdWUgY2hhbmdlZCBhY3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IG5ldyBDb250cm9sSGFuZGxlcihuZXcgRGF0ZU1hbmFnZXJXaXRoQ29uZmlybWF0aW9uKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGVzdEUyRShyZXF1ZXN0SGFuZGxlciwgW1xuICAgICAgICAgICAgICAgICdVOiAyMDE4JywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyBcIkFNQVpPTi5EQVRFXCI6ICcyMDE4JyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdhcyB0aGF0IDIwMTg/JyxcbiAgICAgICAgICAgICAgICAnVTogWWVzLicsIFRlc3RJbnB1dC5vZihHZW5lcmFsQ29udHJvbEludGVudC5vZih7IGZlZWRiYWNrOiAkLkZlZWRiYWNrLkFmZmlybSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IEdyZWF0LicsXG4gICAgICAgICAgICAgICAgJ1U6IENoYW5nZSB0byAwOC0xMi0xOTkzLicsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJBTUFaT04uREFURVwiOiAnMDgtMTItMTk5MycsIFwiYWN0aW9uXCI6ICQuQWN0aW9uLkNoYW5nZSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdhcyB0aGF0IDA4LTEyLTE5OTM/JyxcbiAgICAgICAgICAgICAgICAnVTogWWVzLicsIFRlc3RJbnB1dC5vZihHZW5lcmFsQ29udHJvbEludGVudC5vZih7IGZlZWRiYWNrOiAkLkZlZWRiYWNrLkFmZmlybSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IEdyZWF0LiBDaGFuZ2VkIGZyb20gMjAxOCB0byAwOC0xMi0xOTkzLidcbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdkYXRlIHZhbHVlIHNldCBhbmQgY2hhbmdpbmcgaXQgdG8gaW52YWxpZCByZXF1aXJlcyBjb25maXJtYXRpb24gYW5kIGNoZWNrcyBmb3IgdmFsaWRhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IG5ldyBDb250cm9sSGFuZGxlcihuZXcgRGF0ZU1hbmFnZXJXaXRoQ29uZmlybWF0aW9uKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGVzdEUyRShyZXF1ZXN0SGFuZGxlciwgW1xuICAgICAgICAgICAgICAgICdVOiAyMDE4JywgVGVzdElucHV0Lm9mKFNpbmdsZVZhbHVlQ29udHJvbEludGVudC5vZihBbWF6b25CdWlsdEluU2xvdFR5cGUuREFURSwgeyBcIkFNQVpPTi5EQVRFXCI6ICcyMDE4JyB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdhcyB0aGF0IDIwMTg/JyxcbiAgICAgICAgICAgICAgICAnVTogWWVzLicsIFRlc3RJbnB1dC5vZihHZW5lcmFsQ29udHJvbEludGVudC5vZih7IGZlZWRiYWNrOiAkLkZlZWRiYWNrLkFmZmlybSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IEdyZWF0LicsXG4gICAgICAgICAgICAgICAgJ1U6IENoYW5nZSB0byAyMDIxLicsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJBTUFaT04uREFURVwiOiAnMjAyMScsIFwiYWN0aW9uXCI6ICQuQWN0aW9uLkNoYW5nZSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdhcyB0aGF0IDIwMjE/JyxcbiAgICAgICAgICAgICAgICAnVTogWWVzLicsIFRlc3RJbnB1dC5vZihHZW5lcmFsQ29udHJvbEludGVudC5vZih7IGZlZWRiYWNrOiAkLkZlZWRiYWNrLkFmZmlybSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFNvcnJ5IGJ1dCB0aGF0XFwncyBub3QgYSB2YWxpZCBkYXRlIGJlY2F1c2UgdGhlIGRhdGUgY2Fubm90IGJlIGdyZWF0ZXIgdGhhbiB0b2RheS4gV2hhdCBzaG91bGQgSSBjaGFuZ2UgaXQgdG8/JyxcbiAgICAgICAgICAgICAgICAnVTogMjAwMC4nLCBUZXN0SW5wdXQub2YoU2luZ2xlVmFsdWVDb250cm9sSW50ZW50Lm9mKEFtYXpvbkJ1aWx0SW5TbG90VHlwZS5EQVRFLCB7IFwiQU1BWk9OLkRBVEVcIjogJzIwMDAnfSkpLFxuICAgICAgICAgICAgICAgICdBOiBXYXMgdGhhdCAyMDAwPycsXG4gICAgICAgICAgICAgICAgJ1U6IE5vLicsIFRlc3RJbnB1dC5vZihHZW5lcmFsQ29udHJvbEludGVudC5vZih7IGZlZWRiYWNrOiAkLkZlZWRiYWNrLkRpc2FmZmlybSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IE15IG1pc3Rha2UuIFdoYXQgZGF0ZT8nLFxuICAgICAgICAgICAgICAgICdVOiAyMDE2LicsIFRlc3RJbnB1dC5vZihTaW5nbGVWYWx1ZUNvbnRyb2xJbnRlbnQub2YoQW1hem9uQnVpbHRJblNsb3RUeXBlLkRBVEUsIHsgXCJBTUFaT04uREFURVwiOiAnMjAxNid9KSksXG4gICAgICAgICAgICAgICAgJ0E6IFdhcyB0aGF0IDIwMTY/JyxcbiAgICAgICAgICAgICAgICAnVTogWWVzLicsIFRlc3RJbnB1dC5vZihHZW5lcmFsQ29udHJvbEludGVudC5vZih7IGZlZWRiYWNrOiAkLkZlZWRiYWNrLkFmZmlybSB9KSksXG4gICAgICAgICAgICAgICAgJ0E6IEdyZWF0LiBDaGFuZ2VkIGZyb20gMjAwMCB0byAyMDE2LidcbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl19