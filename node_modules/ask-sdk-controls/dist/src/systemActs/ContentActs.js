"use strict";
/*
 * Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License").
 * You may not use this file except in compliance with the License.
 * A copy of the License is located at
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * or in the "license" file accompanying this file. This file is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.LiteralContentAct = exports.LaunchAct = exports.NonUnderstandingAct = exports.ProblematicInputValueAct = exports.InformConfusingDisconfirmationAct = exports.InformConfusingConfirmationAct = exports.ValueDisconfirmedAct = exports.ValueConfirmedAct = exports.InvalidValueAct = exports.ValueChangedAct = exports.ValueSetAct = exports.AcknowledgeInputAct = exports.UnusableInputValueAct = exports.ContentAct = void 0;
const SystemAct_1 = require("./SystemAct");
/**
 * Base type for System Acts that provides 'content' or 'simple information'.
 *
 * An act is 'content' if it does not directly encourage the user to reply.
 *
 * Examples:
 *   * ApologyAct  is-a  ContentAct.  Sample prompt: "A: Sorry, my mistake."         (simple information, no encouragement to continue)
 *   * WeatherAct  is-a  ContentAct.  Sample prompt: "A: The weather will be warm."  (business content, no encouragement to continue)
 *
 * Framework behavior:
 *  * The framework requires that every turn includes exactly one InitiativeAct except for
 *    terminal turns that stop the user's session by setting `ControlResult.sessionBehavior`.
 */
class ContentAct extends SystemAct_1.SystemAct {
    constructor(control) {
        super(control, { takesInitiative: false });
    }
}
exports.ContentAct = ContentAct;
/**
 * Communicates that an input cannot be consumed.
 *
 * Typically, 'invalid input' means that the input cannot be consumed given the current state of the skill and the input will be ignored.
 *
 * Default rendering (en-US): "Sorry, {renderedReason}."
 *
 * Usage:
 *  * Controls should override the render and provide more detail about the specific problem by rendering
 *    the reasonCode.
 *
 * Example:
 *   * A list control offers three options but the user says "The fourth one".
 */
class UnusableInputValueAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        if (this.payload.renderedReason !== undefined) {
            controlResponseBuilder.addPromptFragment(`Sorry, ${this.payload.renderedReason}.`);
        }
        else {
            throw new Error(`Cannot directly render UnusableInputAct as payload.renderedReason is undefined. ${this.toString()}. `
                + `Either provide a renderedReason when creating the act, or render the act in control.render() or controlManager.render()`);
        }
    }
}
exports.UnusableInputValueAct = UnusableInputValueAct;
/**
 * Communicates that input was received an interpreted successfully.
 *
 * Default rendering (en-US): "OK."
 *
 * Usage:
 *  * Often a more specific act (e.g. ValueSetAct) will be used to describe more
 *    precisely what was understood and acted upon.
 *  * Do not issue `AcknowledgeInputAct` if another act has been issued that
 *    also conveys that the user's input was received and interpreted successfully.
 */
class AcknowledgeInputAct extends ContentAct {
    constructor(control) {
        super(control);
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment('OK.');
    }
}
exports.AcknowledgeInputAct = AcknowledgeInputAct;
/**
 * Communicates that a value was received and recorded.
 *
 * This act does not imply that the value is valid or otherwise meets
 * any requirements.  It merely communicates successful reception.
 *
 * This act implies that there was no significant ambiguity.  In situations were
 * ambiguity is present a more specific act should be created and issued to communicate
 * that clearly to the user.
 *
 * Default rendering (en-US): "OK, {value}".
 *
 * Usage:
 *  * If received value overrides a value previously obtained from the user
 *    it is preferable to issue a `ValueChangedAct` which is more specific to that case.
 *  * Typically issued when a Control elicits a value from the user and the
 *    user replies directly.
 *  * Also issued when the user provides data on their own initiative which
 *    can be interpreted unambiguously, e.g. "U: Send it on Thursday".
 */
class ValueSetAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment(`OK, ${this.payload.value}.`);
    }
}
exports.ValueSetAct = ValueSetAct;
/**
 * Communicates that a value was received and recorded as a change to previously obtained information.
 *
 * This act does not imply that the value is valid or otherwise meets
 * any requirements.  It merely communicates successful reception.
 *
 * This act implies that there was no significant ambiguity.  In situations were
 * ambiguity is present a more specific act should be created and issued to communicate
 * that clearly to the user.
 *
 * Default rendering (en-US): "OK, updated to {value}."
 *
 * Usage:
 *  * Typically issued when a user explicitly changes a value, e.g. 'actually change it to tomorrow'.
 *  * Also issued when the user provides data on their own initiative which override previous data
 *    e.g. "U: Send it Monday" ... then later ...  "U: Send it on Thursday".
 */
class ValueChangedAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment(`OK, updated to ${this.payload.value}.`);
    }
}
exports.ValueChangedAct = ValueChangedAct;
/**
 * Communicates that a value is invalid.
 *
 * Typically, 'invalid' means that a value cannot be used in business functions with the implication that it
 * must be corrected or retracted before the user can complete their task.
 *
 * Note that a value can become invalid due to external causes as the validation rules can access other controls and context.
 *
 * Default rendering (en-US): "Sorry, {renderedReason}."
 *
 * Usage:
 *  * Controls should override the render and provide more detail about the specific problem by rendering
 *    the reasonCode.
 */
class InvalidValueAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        if (this.payload.renderedReason !== undefined) {
            controlResponseBuilder.addPromptFragment(`Sorry, ${this.payload.renderedReason}.`);
        }
        else {
            throw new Error(`Cannot directly render InvalidValueAct as payload.renderedReason is undefined. ${this.toString()}. `
                + `Either provide a renderedReason when creating the act, or render the act in control.render() or controlManager.render()`);
        }
    }
}
exports.InvalidValueAct = InvalidValueAct;
/**
 * Communicates that a value has been positively confirmed.
 *
 * Default rendering (en-US): "Great."
 *
 * Usage:
 *  * Typically issued when the system issued a ConfirmValueAct and received an `affirm` in reply.
 *  * May also be issued in cases where the user repeats a value which is interpreted as confirmation.
 *
 * Example:
 * ```
 * "A: Did you say three?"    ConfirmValueAct
 * "U: Yes"                   GeneralControlIntent( feedback = affirm )
 * "A: Great. <initiative>."  ValueConfirmedAct, <InitiativeAct>
 * ```
 */
class ValueConfirmedAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment('Great.');
    }
}
exports.ValueConfirmedAct = ValueConfirmedAct;
/**
 * Communicates that a value has been disconfirmed.
 *
  * Default rendering (en-US): "My mistake."
 *
 * Usage:
 *  * Typically issued when the system issued a ConfirmValueAct and received a `disaffirm` in reply.
 *  * Also issued when the users realizes that a value is incorrect and corrects it directly "No, that should be three"
 *
 * Example:
 * ```
 * "A: Did you say three?"         ConfirmValueAct
 * "U: No."                        GeneralControlIntent( feedback = disaffirm )
 * "A: My mistake. <initiative>."  ValueDisconfirmedAct, <InitiativeAct>
 * ```
 */
class ValueDisconfirmedAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment('My mistake.');
    }
}
exports.ValueDisconfirmedAct = ValueDisconfirmedAct;
/**
 * Communicates that a confusing value confirmation was received.
 *
 * Default rendering (en-US): "I'm confused whether you want ${this.control.state.value} or ${this.payload.value}."
 *
 * Usage:
 *  * Typically issued when the system issued a ConfirmValueAct and received an `affirm` in reply with a different value .
 *
 * Example:
 * ```
 * "A: Did you say three?"             ConfirmValueAct
 * "U: Yes, four"                      AMAZON_NUMBER_ValueControlIntent( feedback = affirm, AMAZON.NUMBER = 4 )
 * "A: I'm confused... <initiative>."  ValueConfirmedAct, <InitiativeAct>
 * ```
 */
class InformConfusingConfirmationAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment(`I'm confused whether you want ${this.control.state.value} or ${this.payload.value}.`);
    }
}
exports.InformConfusingConfirmationAct = InformConfusingConfirmationAct;
/**
 * Communicates that a confusing value disconfirmation was received.
 *
 * Default rendering (en-US): "I'm confused whether you want ${this.control.state.value} or not."
 *
 * Usage:
 *  * Typically issued when the system issued a ConfirmValueAct and received an `disaffirm` in reply with the mentioned value repeated.
 *
 * Example:
 * ```
 * "A: Did you say three?"             ConfirmValueAct
 * "U: No, three"                      AMAZON_NUMBER_ValueControlIntent( feedback = affirm, AMAZON.NUMBER = 4 )
 * "A: I'm confused... <initiative>."  ValueConfirmedAct, <InitiativeAct>
 * ```
 */
class InformConfusingDisconfirmationAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment(`I'm confused whether you want ${this.control.state.value} or not.`);
    }
}
exports.InformConfusingDisconfirmationAct = InformConfusingDisconfirmationAct;
/**
 * Communicates that a value was received which is considered to be problematic.
 *
 * Default rendering (en-US): "I'm really sorry but I heard {value} again."
 *
 * Usage:
 *  * Typically issued if the user has already disconfirmed that value but we hear it again.
 *
 * "U: three"
 * "A: Did you say three?"
 * "U: No"
 * "A: My mistake, how many would you like?"
 * "U: three"
 * "A: I'm really sorry but I heard three again."
 */
class ProblematicInputValueAct extends ContentAct {
    constructor(control, payload) {
        super(control);
        this.payload = payload;
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment(`I'm really sorry but I heard ${this.payload.value} again.`);
    }
}
exports.ProblematicInputValueAct = ProblematicInputValueAct;
/**
 * Communicates that the user's input could not be understood.
 *
 * Default rendering (en-US): "Sorry I didn't understand that."
 *
 * Usage:
 * * Typically issued in response to AMAZON.FallbackIntent.
 * * May also be issued as a generic response when an input doesn't make any
 *   sense given the state of the skill.
 *
 * Example 1:
 * "U: <gibberish>"  AMAZON.FallbackIntent
 * "A: Sorry I didn't understand that."
 *
 * Example 2:
 * "U: change Bob to Frank" ... but no Control is tracking a value of "Bob"
 * "A: Sorry I didn't understand that."
 */
class NonUnderstandingAct extends ContentAct {
    constructor(control) {
        super(control);
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment('Sorry I didn\'t understand that.');
    }
}
exports.NonUnderstandingAct = NonUnderstandingAct;
/**
 * Communicates that the skill was launched.
 *
 * Default rendering (en-US): "Welcome."
 */
class LaunchAct extends ContentAct {
    constructor(control) {
        super(control);
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment('Welcome.');
    }
}
exports.LaunchAct = LaunchAct;
/**
 * Communicates an arbitrary message to the user.
 *
 * Default:
 *  * The repromptFragment defaults to be identical to promptFragment.
 *
 * Usage:
 *  * Use LiteralContentAct only in simple situations where it would be annoying
 *    to create a new custom act only to have a single way to render it.
 *  * In contrast, specific content acts convey information more clearly,
 *    maintain controller/view separation and can often be reused in additional scenarios.
 *
 */
class LiteralContentAct extends ContentAct {
    constructor(control, payload) {
        var _a;
        super(control);
        this.payload = {
            promptFragment: payload.promptFragment,
            repromptFragment: (_a = payload.repromptFragment) !== null && _a !== void 0 ? _a : payload.promptFragment
        };
    }
    render(input, controlResponseBuilder) {
        controlResponseBuilder.addPromptFragment(this.payload.promptFragment);
        controlResponseBuilder.addRepromptFragment(this.payload.repromptFragment);
    }
}
exports.LiteralContentAct = LiteralContentAct;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udGVudEFjdHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvc3lzdGVtQWN0cy9Db250ZW50QWN0cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7O0dBV0c7OztBQU9ILDJDQUF3QztBQUV4Qzs7Ozs7Ozs7Ozs7O0dBWUc7QUFDSCxNQUFzQixVQUFXLFNBQVEscUJBQVM7SUFDOUMsWUFBWSxPQUFnQjtRQUN4QixLQUFLLENBQUMsT0FBTyxFQUFFLEVBQUMsZUFBZSxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7SUFDN0MsQ0FBQztDQUNKO0FBSkQsZ0NBSUM7QUFFRDs7Ozs7Ozs7Ozs7OztHQWFHO0FBQ0gsTUFBYSxxQkFBeUIsU0FBUSxVQUFVO0lBR3BELFlBQVksT0FBZ0IsRUFBRSxPQUF3QztRQUNsRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztJQUMzQixDQUFDO0lBRUQsTUFBTSxDQUFDLEtBQW1CLEVBQUUsc0JBQThDO1FBQ3RFLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxjQUFjLEtBQUssU0FBUyxFQUFDO1lBQzFDLHNCQUFzQixDQUFDLGlCQUFpQixDQUFDLFVBQVUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxjQUFjLEdBQUcsQ0FBQyxDQUFDO1NBQ3RGO2FBQ0k7WUFDRCxNQUFNLElBQUksS0FBSyxDQUFDLG1GQUFtRixJQUFJLENBQUMsUUFBUSxFQUFFLElBQUk7a0JBQ3BILHlIQUF5SCxDQUFDLENBQUM7U0FDaEk7SUFDTCxDQUFDO0NBQ0o7QUFqQkQsc0RBaUJDO0FBR0Q7Ozs7Ozs7Ozs7R0FVRztBQUNILE1BQWEsbUJBQW9CLFNBQVEsVUFBVTtJQUMvQyxZQUFZLE9BQWdCO1FBQ3hCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNuQixDQUFDO0lBRUQsTUFBTSxDQUFDLEtBQW1CLEVBQUUsc0JBQThDO1FBQ3RF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Q0FBQyxpQkFBaUIsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO0lBQ2pGLENBQUM7Q0FDSjtBQVJELGtEQVFDO0FBRUQ7Ozs7R0FJRztBQUNILE1BQWEsU0FBVSxTQUFRLFVBQVU7SUFDckMsWUFBWSxPQUFnQjtRQUN4QixLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDbkIsQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUFtQixFQUFFLHNCQUE4QztRQUN0RSxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN6RCxDQUFDO0NBQ0o7QUFSRCw4QkFRQztBQUVEOzs7Ozs7Ozs7Ozs7R0FZRztBQUNILE1BQWEsaUJBQWtCLFNBQVEsVUFBVTtJQUc3QyxZQUFZLE9BQWdCLEVBQUUsT0FBOEI7O1FBQ3hELEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNmLElBQUksQ0FBQyxPQUFPLEdBQUc7WUFDWCxjQUFjLEVBQUUsT0FBTyxDQUFDLGNBQWM7WUFDdEMsZ0JBQWdCLFFBQUUsT0FBTyxDQUFDLGdCQUFnQixtQ0FBSSxPQUFPLENBQUMsY0FBYztTQUN2RSxDQUFDO0lBQ04sQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUFtQixFQUFFLHNCQUE4QztRQUN0RSxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ3RFLHNCQUFzQixDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsZ0JBQWlCLENBQUMsQ0FBQztJQUMvRSxDQUFDO0NBQ0o7QUFmRCw4Q0FlQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxOSBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS5cbiAqIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIG9yIGluIHRoZSBcImxpY2Vuc2VcIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZFxuICogb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyXG4gKiBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZ1xuICogcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuaW1wb3J0IHsgQ29udHJvbCB9IGZyb20gJy4uL2NvbnRyb2xzL0NvbnRyb2wnO1xuaW1wb3J0IHsgQ29udHJvbElucHV0IH0gZnJvbSAnLi4vY29udHJvbHMvQ29udHJvbElucHV0JztcbmltcG9ydCB7IENvbnRyb2xSZXNwb25zZUJ1aWxkZXIgfSBmcm9tICcuLi9yZXNwb25zZUdlbmVyYXRpb24vQ29udHJvbFJlc3BvbnNlQnVpbGRlcic7XG5pbXBvcnQgeyBJbnZhbGlkVmFsdWVQYXlsb2FkLCBMaXRlcmFsQ29udGVudFBheWxvYWQsIFByb2JsZW1hdGljSW5wdXRWYWx1ZVBheWxvYWQsIFZhbHVlQ2hhbmdlZFBheWxvYWQsIFZhbHVlU2V0UGF5bG9hZCB9IGZyb20gJy4vUGF5bG9hZFR5cGVzJztcbmltcG9ydCB7IFN5c3RlbUFjdCB9IGZyb20gJy4vU3lzdGVtQWN0JztcblxuLyoqXG4gKiBCYXNlIHR5cGUgZm9yIFN5c3RlbSBBY3RzIHRoYXQgcHJvdmlkZXMgJ2NvbnRlbnQnIG9yICdzaW1wbGUgaW5mb3JtYXRpb24nLlxuICpcbiAqIEFuIGFjdCBpcyAnY29udGVudCcgaWYgaXQgZG9lcyBub3QgZGlyZWN0bHkgZW5jb3VyYWdlIHRoZSB1c2VyIHRvIHJlcGx5LlxuICpcbiAqIEV4YW1wbGVzOlxuICogICAqIEFwb2xvZ3lBY3QgIGlzLWEgIENvbnRlbnRBY3QuICBTYW1wbGUgcHJvbXB0OiBcIkE6IFNvcnJ5LCBteSBtaXN0YWtlLlwiICAgICAgICAgKHNpbXBsZSBpbmZvcm1hdGlvbiwgbm8gZW5jb3VyYWdlbWVudCB0byBjb250aW51ZSlcbiAqICAgKiBXZWF0aGVyQWN0ICBpcy1hICBDb250ZW50QWN0LiAgU2FtcGxlIHByb21wdDogXCJBOiBUaGUgd2VhdGhlciB3aWxsIGJlIHdhcm0uXCIgIChidXNpbmVzcyBjb250ZW50LCBubyBlbmNvdXJhZ2VtZW50IHRvIGNvbnRpbnVlKVxuICpcbiAqIEZyYW1ld29yayBiZWhhdmlvcjpcbiAqICAqIFRoZSBmcmFtZXdvcmsgcmVxdWlyZXMgdGhhdCBldmVyeSB0dXJuIGluY2x1ZGVzIGV4YWN0bHkgb25lIEluaXRpYXRpdmVBY3QgZXhjZXB0IGZvclxuICogICAgdGVybWluYWwgdHVybnMgdGhhdCBzdG9wIHRoZSB1c2VyJ3Mgc2Vzc2lvbiBieSBzZXR0aW5nIGBDb250cm9sUmVzdWx0LnNlc3Npb25CZWhhdmlvcmAuXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb250ZW50QWN0IGV4dGVuZHMgU3lzdGVtQWN0IHtcbiAgICBjb25zdHJ1Y3Rvcihjb250cm9sOiBDb250cm9sKXtcbiAgICAgICAgc3VwZXIoY29udHJvbCwge3Rha2VzSW5pdGlhdGl2ZTogZmFsc2V9KTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29tbXVuaWNhdGVzIHRoYXQgYW4gaW5wdXQgY2Fubm90IGJlIGNvbnN1bWVkLlxuICpcbiAqIFR5cGljYWxseSwgJ2ludmFsaWQgaW5wdXQnIG1lYW5zIHRoYXQgdGhlIGlucHV0IGNhbm5vdCBiZSBjb25zdW1lZCBnaXZlbiB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgc2tpbGwgYW5kIHRoZSBpbnB1dCB3aWxsIGJlIGlnbm9yZWQuXG4gKlxuICogRGVmYXVsdCByZW5kZXJpbmcgKGVuLVVTKTogXCJTb3JyeSwge3JlbmRlcmVkUmVhc29ufS5cIlxuICpcbiAqIFVzYWdlOlxuICogICogQ29udHJvbHMgc2hvdWxkIG92ZXJyaWRlIHRoZSByZW5kZXIgYW5kIHByb3ZpZGUgbW9yZSBkZXRhaWwgYWJvdXQgdGhlIHNwZWNpZmljIHByb2JsZW0gYnkgcmVuZGVyaW5nXG4gKiAgICB0aGUgcmVhc29uQ29kZS5cbiAqXG4gKiBFeGFtcGxlOlxuICogICAqIEEgbGlzdCBjb250cm9sIG9mZmVycyB0aHJlZSBvcHRpb25zIGJ1dCB0aGUgdXNlciBzYXlzIFwiVGhlIGZvdXJ0aCBvbmVcIi5cbiAqL1xuZXhwb3J0IGNsYXNzIFVudXNhYmxlSW5wdXRWYWx1ZUFjdDxUPiBleHRlbmRzIENvbnRlbnRBY3Qge1xuICAgIHB1YmxpYyByZWFkb25seSBwYXlsb2FkOiBQcm9ibGVtYXRpY0lucHV0VmFsdWVQYXlsb2FkPFQ+O1xuXG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCwgcGF5bG9hZDogUHJvYmxlbWF0aWNJbnB1dFZhbHVlUGF5bG9hZDxUPikge1xuICAgICAgICBzdXBlcihjb250cm9sKTtcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gcGF5bG9hZDtcbiAgICB9XG5cbiAgICByZW5kZXIoaW5wdXQ6IENvbnRyb2xJbnB1dCwgY29udHJvbFJlc3BvbnNlQnVpbGRlcjogQ29udHJvbFJlc3BvbnNlQnVpbGRlcik6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wYXlsb2FkLnJlbmRlcmVkUmVhc29uICE9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgY29udHJvbFJlc3BvbnNlQnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudChgU29ycnksICR7dGhpcy5wYXlsb2FkLnJlbmRlcmVkUmVhc29ufS5gKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGRpcmVjdGx5IHJlbmRlciBVbnVzYWJsZUlucHV0QWN0IGFzIHBheWxvYWQucmVuZGVyZWRSZWFzb24gaXMgdW5kZWZpbmVkLiAke3RoaXMudG9TdHJpbmcoKX0uIGBcbiAgICAgICAgICAgICsgYEVpdGhlciBwcm92aWRlIGEgcmVuZGVyZWRSZWFzb24gd2hlbiBjcmVhdGluZyB0aGUgYWN0LCBvciByZW5kZXIgdGhlIGFjdCBpbiBjb250cm9sLnJlbmRlcigpIG9yIGNvbnRyb2xNYW5hZ2VyLnJlbmRlcigpYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuLyoqXG4gKiBDb21tdW5pY2F0ZXMgdGhhdCBpbnB1dCB3YXMgcmVjZWl2ZWQgYW4gaW50ZXJwcmV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICpcbiAqIERlZmF1bHQgcmVuZGVyaW5nIChlbi1VUyk6IFwiT0suXCJcbiAqXG4gKiBVc2FnZTpcbiAqICAqIE9mdGVuIGEgbW9yZSBzcGVjaWZpYyBhY3QgKGUuZy4gVmFsdWVTZXRBY3QpIHdpbGwgYmUgdXNlZCB0byBkZXNjcmliZSBtb3JlXG4gKiAgICBwcmVjaXNlbHkgd2hhdCB3YXMgdW5kZXJzdG9vZCBhbmQgYWN0ZWQgdXBvbi5cbiAqICAqIERvIG5vdCBpc3N1ZSBgQWNrbm93bGVkZ2VJbnB1dEFjdGAgaWYgYW5vdGhlciBhY3QgaGFzIGJlZW4gaXNzdWVkIHRoYXRcbiAqICAgIGFsc28gY29udmV5cyB0aGF0IHRoZSB1c2VyJ3MgaW5wdXQgd2FzIHJlY2VpdmVkIGFuZCBpbnRlcnByZXRlZCBzdWNjZXNzZnVsbHkuXG4gKi9cbmV4cG9ydCBjbGFzcyBBY2tub3dsZWRnZUlucHV0QWN0IGV4dGVuZHMgQ29udGVudEFjdCB7XG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCkge1xuICAgICAgICBzdXBlcihjb250cm9sKTtcbiAgICB9XG5cbiAgICByZW5kZXIoaW5wdXQ6IENvbnRyb2xJbnB1dCwgY29udHJvbFJlc3BvbnNlQnVpbGRlcjogQ29udHJvbFJlc3BvbnNlQnVpbGRlcik6IHZvaWQge1xuICAgICAgICBjb250cm9sUmVzcG9uc2VCdWlsZGVyLmFkZFByb21wdEZyYWdtZW50KCdPSy4nKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29tbXVuaWNhdGVzIHRoYXQgYSB2YWx1ZSB3YXMgcmVjZWl2ZWQgYW5kIHJlY29yZGVkLlxuICpcbiAqIFRoaXMgYWN0IGRvZXMgbm90IGltcGx5IHRoYXQgdGhlIHZhbHVlIGlzIHZhbGlkIG9yIG90aGVyd2lzZSBtZWV0c1xuICogYW55IHJlcXVpcmVtZW50cy4gIEl0IG1lcmVseSBjb21tdW5pY2F0ZXMgc3VjY2Vzc2Z1bCByZWNlcHRpb24uXG4gKlxuICogVGhpcyBhY3QgaW1wbGllcyB0aGF0IHRoZXJlIHdhcyBubyBzaWduaWZpY2FudCBhbWJpZ3VpdHkuICBJbiBzaXR1YXRpb25zIHdlcmVcbiAqIGFtYmlndWl0eSBpcyBwcmVzZW50IGEgbW9yZSBzcGVjaWZpYyBhY3Qgc2hvdWxkIGJlIGNyZWF0ZWQgYW5kIGlzc3VlZCB0byBjb21tdW5pY2F0ZVxuICogdGhhdCBjbGVhcmx5IHRvIHRoZSB1c2VyLlxuICpcbiAqIERlZmF1bHQgcmVuZGVyaW5nIChlbi1VUyk6IFwiT0ssIHt2YWx1ZX1cIi5cbiAqXG4gKiBVc2FnZTpcbiAqICAqIElmIHJlY2VpdmVkIHZhbHVlIG92ZXJyaWRlcyBhIHZhbHVlIHByZXZpb3VzbHkgb2J0YWluZWQgZnJvbSB0aGUgdXNlclxuICogICAgaXQgaXMgcHJlZmVyYWJsZSB0byBpc3N1ZSBhIGBWYWx1ZUNoYW5nZWRBY3RgIHdoaWNoIGlzIG1vcmUgc3BlY2lmaWMgdG8gdGhhdCBjYXNlLlxuICogICogVHlwaWNhbGx5IGlzc3VlZCB3aGVuIGEgQ29udHJvbCBlbGljaXRzIGEgdmFsdWUgZnJvbSB0aGUgdXNlciBhbmQgdGhlXG4gKiAgICB1c2VyIHJlcGxpZXMgZGlyZWN0bHkuXG4gKiAgKiBBbHNvIGlzc3VlZCB3aGVuIHRoZSB1c2VyIHByb3ZpZGVzIGRhdGEgb24gdGhlaXIgb3duIGluaXRpYXRpdmUgd2hpY2hcbiAqICAgIGNhbiBiZSBpbnRlcnByZXRlZCB1bmFtYmlndW91c2x5LCBlLmcuIFwiVTogU2VuZCBpdCBvbiBUaHVyc2RheVwiLlxuICovXG5leHBvcnQgY2xhc3MgVmFsdWVTZXRBY3Q8VD4gZXh0ZW5kcyBDb250ZW50QWN0IHtcbiAgICBwdWJsaWMgcmVhZG9ubHkgcGF5bG9hZDogVmFsdWVTZXRQYXlsb2FkPFQ+O1xuXG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCwgcGF5bG9hZDogVmFsdWVTZXRQYXlsb2FkPFQ+KSB7XG4gICAgICAgIHN1cGVyKGNvbnRyb2wpO1xuICAgICAgICB0aGlzLnBheWxvYWQgPSBwYXlsb2FkO1xuICAgIH1cblxuICAgIHJlbmRlcihpbnB1dDogQ29udHJvbElucHV0LCBjb250cm9sUmVzcG9uc2VCdWlsZGVyOiBDb250cm9sUmVzcG9uc2VCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIGNvbnRyb2xSZXNwb25zZUJ1aWxkZXIuYWRkUHJvbXB0RnJhZ21lbnQoYE9LLCAke3RoaXMucGF5bG9hZC52YWx1ZX0uYCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbW11bmljYXRlcyB0aGF0IGEgdmFsdWUgd2FzIHJlY2VpdmVkIGFuZCByZWNvcmRlZCBhcyBhIGNoYW5nZSB0byBwcmV2aW91c2x5IG9idGFpbmVkIGluZm9ybWF0aW9uLlxuICpcbiAqIFRoaXMgYWN0IGRvZXMgbm90IGltcGx5IHRoYXQgdGhlIHZhbHVlIGlzIHZhbGlkIG9yIG90aGVyd2lzZSBtZWV0c1xuICogYW55IHJlcXVpcmVtZW50cy4gIEl0IG1lcmVseSBjb21tdW5pY2F0ZXMgc3VjY2Vzc2Z1bCByZWNlcHRpb24uXG4gKlxuICogVGhpcyBhY3QgaW1wbGllcyB0aGF0IHRoZXJlIHdhcyBubyBzaWduaWZpY2FudCBhbWJpZ3VpdHkuICBJbiBzaXR1YXRpb25zIHdlcmVcbiAqIGFtYmlndWl0eSBpcyBwcmVzZW50IGEgbW9yZSBzcGVjaWZpYyBhY3Qgc2hvdWxkIGJlIGNyZWF0ZWQgYW5kIGlzc3VlZCB0byBjb21tdW5pY2F0ZVxuICogdGhhdCBjbGVhcmx5IHRvIHRoZSB1c2VyLlxuICpcbiAqIERlZmF1bHQgcmVuZGVyaW5nIChlbi1VUyk6IFwiT0ssIHVwZGF0ZWQgdG8ge3ZhbHVlfS5cIlxuICpcbiAqIFVzYWdlOlxuICogICogVHlwaWNhbGx5IGlzc3VlZCB3aGVuIGEgdXNlciBleHBsaWNpdGx5IGNoYW5nZXMgYSB2YWx1ZSwgZS5nLiAnYWN0dWFsbHkgY2hhbmdlIGl0IHRvIHRvbW9ycm93Jy5cbiAqICAqIEFsc28gaXNzdWVkIHdoZW4gdGhlIHVzZXIgcHJvdmlkZXMgZGF0YSBvbiB0aGVpciBvd24gaW5pdGlhdGl2ZSB3aGljaCBvdmVycmlkZSBwcmV2aW91cyBkYXRhXG4gKiAgICBlLmcuIFwiVTogU2VuZCBpdCBNb25kYXlcIiAuLi4gdGhlbiBsYXRlciAuLi4gIFwiVTogU2VuZCBpdCBvbiBUaHVyc2RheVwiLlxuICovXG5leHBvcnQgY2xhc3MgVmFsdWVDaGFuZ2VkQWN0PFQ+IGV4dGVuZHMgQ29udGVudEFjdCB7XG4gICAgcGF5bG9hZDogVmFsdWVDaGFuZ2VkUGF5bG9hZDxUPjtcblxuICAgIGNvbnN0cnVjdG9yKGNvbnRyb2w6IENvbnRyb2wsIHBheWxvYWQ6IFZhbHVlQ2hhbmdlZFBheWxvYWQ8VD4pIHtcbiAgICAgICAgc3VwZXIoY29udHJvbCk7XG4gICAgICAgIHRoaXMucGF5bG9hZCA9IHBheWxvYWQ7XG4gICAgfVxuXG4gICAgcmVuZGVyKGlucHV0OiBDb250cm9sSW5wdXQsIGNvbnRyb2xSZXNwb25zZUJ1aWxkZXI6IENvbnRyb2xSZXNwb25zZUJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgY29udHJvbFJlc3BvbnNlQnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudChgT0ssIHVwZGF0ZWQgdG8gJHt0aGlzLnBheWxvYWQudmFsdWV9LmApO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21tdW5pY2F0ZXMgdGhhdCBhIHZhbHVlIGlzIGludmFsaWQuXG4gKlxuICogVHlwaWNhbGx5LCAnaW52YWxpZCcgbWVhbnMgdGhhdCBhIHZhbHVlIGNhbm5vdCBiZSB1c2VkIGluIGJ1c2luZXNzIGZ1bmN0aW9ucyB3aXRoIHRoZSBpbXBsaWNhdGlvbiB0aGF0IGl0XG4gKiBtdXN0IGJlIGNvcnJlY3RlZCBvciByZXRyYWN0ZWQgYmVmb3JlIHRoZSB1c2VyIGNhbiBjb21wbGV0ZSB0aGVpciB0YXNrLlxuICpcbiAqIE5vdGUgdGhhdCBhIHZhbHVlIGNhbiBiZWNvbWUgaW52YWxpZCBkdWUgdG8gZXh0ZXJuYWwgY2F1c2VzIGFzIHRoZSB2YWxpZGF0aW9uIHJ1bGVzIGNhbiBhY2Nlc3Mgb3RoZXIgY29udHJvbHMgYW5kIGNvbnRleHQuXG4gKlxuICogRGVmYXVsdCByZW5kZXJpbmcgKGVuLVVTKTogXCJTb3JyeSwge3JlbmRlcmVkUmVhc29ufS5cIlxuICpcbiAqIFVzYWdlOlxuICogICogQ29udHJvbHMgc2hvdWxkIG92ZXJyaWRlIHRoZSByZW5kZXIgYW5kIHByb3ZpZGUgbW9yZSBkZXRhaWwgYWJvdXQgdGhlIHNwZWNpZmljIHByb2JsZW0gYnkgcmVuZGVyaW5nXG4gKiAgICB0aGUgcmVhc29uQ29kZS5cbiAqL1xuZXhwb3J0IGNsYXNzIEludmFsaWRWYWx1ZUFjdDxUPiBleHRlbmRzIENvbnRlbnRBY3Qge1xuICAgIHB1YmxpYyByZWFkb25seSBwYXlsb2FkOiBJbnZhbGlkVmFsdWVQYXlsb2FkPFQ+O1xuXG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCwgcGF5bG9hZDogSW52YWxpZFZhbHVlUGF5bG9hZDxUPikge1xuICAgICAgICBzdXBlcihjb250cm9sKTtcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gcGF5bG9hZDtcbiAgICB9XG5cbiAgICByZW5kZXIoaW5wdXQ6IENvbnRyb2xJbnB1dCwgY29udHJvbFJlc3BvbnNlQnVpbGRlcjogQ29udHJvbFJlc3BvbnNlQnVpbGRlcik6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wYXlsb2FkLnJlbmRlcmVkUmVhc29uICE9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgY29udHJvbFJlc3BvbnNlQnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudChgU29ycnksICR7dGhpcy5wYXlsb2FkLnJlbmRlcmVkUmVhc29ufS5gKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGRpcmVjdGx5IHJlbmRlciBJbnZhbGlkVmFsdWVBY3QgYXMgcGF5bG9hZC5yZW5kZXJlZFJlYXNvbiBpcyB1bmRlZmluZWQuICR7dGhpcy50b1N0cmluZygpfS4gYFxuICAgICAgICAgICAgKyBgRWl0aGVyIHByb3ZpZGUgYSByZW5kZXJlZFJlYXNvbiB3aGVuIGNyZWF0aW5nIHRoZSBhY3QsIG9yIHJlbmRlciB0aGUgYWN0IGluIGNvbnRyb2wucmVuZGVyKCkgb3IgY29udHJvbE1hbmFnZXIucmVuZGVyKClgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBDb21tdW5pY2F0ZXMgdGhhdCBhIHZhbHVlIGhhcyBiZWVuIHBvc2l0aXZlbHkgY29uZmlybWVkLlxuICpcbiAqIERlZmF1bHQgcmVuZGVyaW5nIChlbi1VUyk6IFwiR3JlYXQuXCJcbiAqXG4gKiBVc2FnZTpcbiAqICAqIFR5cGljYWxseSBpc3N1ZWQgd2hlbiB0aGUgc3lzdGVtIGlzc3VlZCBhIENvbmZpcm1WYWx1ZUFjdCBhbmQgcmVjZWl2ZWQgYW4gYGFmZmlybWAgaW4gcmVwbHkuXG4gKiAgKiBNYXkgYWxzbyBiZSBpc3N1ZWQgaW4gY2FzZXMgd2hlcmUgdGhlIHVzZXIgcmVwZWF0cyBhIHZhbHVlIHdoaWNoIGlzIGludGVycHJldGVkIGFzIGNvbmZpcm1hdGlvbi5cbiAqXG4gKiBFeGFtcGxlOlxuICogYGBgXG4gKiBcIkE6IERpZCB5b3Ugc2F5IHRocmVlP1wiICAgIENvbmZpcm1WYWx1ZUFjdFxuICogXCJVOiBZZXNcIiAgICAgICAgICAgICAgICAgICBHZW5lcmFsQ29udHJvbEludGVudCggZmVlZGJhY2sgPSBhZmZpcm0gKVxuICogXCJBOiBHcmVhdC4gPGluaXRpYXRpdmU+LlwiICBWYWx1ZUNvbmZpcm1lZEFjdCwgPEluaXRpYXRpdmVBY3Q+XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIFZhbHVlQ29uZmlybWVkQWN0PFQ+IGV4dGVuZHMgQ29udGVudEFjdCB7XG4gICAgcGF5bG9hZDogVmFsdWVTZXRQYXlsb2FkPFQ+O1xuICAgIGNvbnN0cnVjdG9yKGNvbnRyb2w6IENvbnRyb2wsIHBheWxvYWQ6IFZhbHVlU2V0UGF5bG9hZDxUPikge1xuICAgICAgICBzdXBlcihjb250cm9sKTtcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gcGF5bG9hZDtcbiAgICB9XG5cbiAgICByZW5kZXIoaW5wdXQ6IENvbnRyb2xJbnB1dCwgY29udHJvbFJlc3BvbnNlQnVpbGRlcjogQ29udHJvbFJlc3BvbnNlQnVpbGRlcik6IHZvaWQge1xuICAgICAgICBjb250cm9sUmVzcG9uc2VCdWlsZGVyLmFkZFByb21wdEZyYWdtZW50KCdHcmVhdC4nKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29tbXVuaWNhdGVzIHRoYXQgYSB2YWx1ZSBoYXMgYmVlbiBkaXNjb25maXJtZWQuXG4gKlxuICAqIERlZmF1bHQgcmVuZGVyaW5nIChlbi1VUyk6IFwiTXkgbWlzdGFrZS5cIlxuICpcbiAqIFVzYWdlOlxuICogICogVHlwaWNhbGx5IGlzc3VlZCB3aGVuIHRoZSBzeXN0ZW0gaXNzdWVkIGEgQ29uZmlybVZhbHVlQWN0IGFuZCByZWNlaXZlZCBhIGBkaXNhZmZpcm1gIGluIHJlcGx5LlxuICogICogQWxzbyBpc3N1ZWQgd2hlbiB0aGUgdXNlcnMgcmVhbGl6ZXMgdGhhdCBhIHZhbHVlIGlzIGluY29ycmVjdCBhbmQgY29ycmVjdHMgaXQgZGlyZWN0bHkgXCJObywgdGhhdCBzaG91bGQgYmUgdGhyZWVcIlxuICpcbiAqIEV4YW1wbGU6XG4gKiBgYGBcbiAqIFwiQTogRGlkIHlvdSBzYXkgdGhyZWU/XCIgICAgICAgICBDb25maXJtVmFsdWVBY3RcbiAqIFwiVTogTm8uXCIgICAgICAgICAgICAgICAgICAgICAgICBHZW5lcmFsQ29udHJvbEludGVudCggZmVlZGJhY2sgPSBkaXNhZmZpcm0gKVxuICogXCJBOiBNeSBtaXN0YWtlLiA8aW5pdGlhdGl2ZT4uXCIgIFZhbHVlRGlzY29uZmlybWVkQWN0LCA8SW5pdGlhdGl2ZUFjdD5cbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVmFsdWVEaXNjb25maXJtZWRBY3Q8VD4gZXh0ZW5kcyBDb250ZW50QWN0IHtcbiAgICBwYXlsb2FkOiBWYWx1ZVNldFBheWxvYWQ8VD47XG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCwgcGF5bG9hZDogVmFsdWVTZXRQYXlsb2FkPFQ+KSB7XG4gICAgICAgIHN1cGVyKGNvbnRyb2wpO1xuICAgICAgICB0aGlzLnBheWxvYWQgPSBwYXlsb2FkO1xuICAgIH1cblxuICAgIHJlbmRlcihpbnB1dDogQ29udHJvbElucHV0LCBjb250cm9sUmVzcG9uc2VCdWlsZGVyOiBDb250cm9sUmVzcG9uc2VCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIGNvbnRyb2xSZXNwb25zZUJ1aWxkZXIuYWRkUHJvbXB0RnJhZ21lbnQoJ015IG1pc3Rha2UuJyk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbW11bmljYXRlcyB0aGF0IGEgY29uZnVzaW5nIHZhbHVlIGNvbmZpcm1hdGlvbiB3YXMgcmVjZWl2ZWQuXG4gKlxuICogRGVmYXVsdCByZW5kZXJpbmcgKGVuLVVTKTogXCJJJ20gY29uZnVzZWQgd2hldGhlciB5b3Ugd2FudCAke3RoaXMuY29udHJvbC5zdGF0ZS52YWx1ZX0gb3IgJHt0aGlzLnBheWxvYWQudmFsdWV9LlwiXG4gKlxuICogVXNhZ2U6XG4gKiAgKiBUeXBpY2FsbHkgaXNzdWVkIHdoZW4gdGhlIHN5c3RlbSBpc3N1ZWQgYSBDb25maXJtVmFsdWVBY3QgYW5kIHJlY2VpdmVkIGFuIGBhZmZpcm1gIGluIHJlcGx5IHdpdGggYSBkaWZmZXJlbnQgdmFsdWUgLlxuICpcbiAqIEV4YW1wbGU6XG4gKiBgYGBcbiAqIFwiQTogRGlkIHlvdSBzYXkgdGhyZWU/XCIgICAgICAgICAgICAgQ29uZmlybVZhbHVlQWN0XG4gKiBcIlU6IFllcywgZm91clwiICAgICAgICAgICAgICAgICAgICAgIEFNQVpPTl9OVU1CRVJfVmFsdWVDb250cm9sSW50ZW50KCBmZWVkYmFjayA9IGFmZmlybSwgQU1BWk9OLk5VTUJFUiA9IDQgKVxuICogXCJBOiBJJ20gY29uZnVzZWQuLi4gPGluaXRpYXRpdmU+LlwiICBWYWx1ZUNvbmZpcm1lZEFjdCwgPEluaXRpYXRpdmVBY3Q+XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEluZm9ybUNvbmZ1c2luZ0NvbmZpcm1hdGlvbkFjdDxUPiBleHRlbmRzIENvbnRlbnRBY3Qge1xuICAgIHBheWxvYWQ6IFByb2JsZW1hdGljSW5wdXRWYWx1ZVBheWxvYWQ8VD47XG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCwgcGF5bG9hZDogUHJvYmxlbWF0aWNJbnB1dFZhbHVlUGF5bG9hZDxUPikge1xuICAgICAgICBzdXBlcihjb250cm9sKTtcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gcGF5bG9hZDtcbiAgICB9XG5cbiAgICByZW5kZXIoaW5wdXQ6IENvbnRyb2xJbnB1dCwgY29udHJvbFJlc3BvbnNlQnVpbGRlcjogQ29udHJvbFJlc3BvbnNlQnVpbGRlcik6IHZvaWQge1xuICAgICAgICBjb250cm9sUmVzcG9uc2VCdWlsZGVyLmFkZFByb21wdEZyYWdtZW50KGBJJ20gY29uZnVzZWQgd2hldGhlciB5b3Ugd2FudCAke3RoaXMuY29udHJvbC5zdGF0ZS52YWx1ZX0gb3IgJHt0aGlzLnBheWxvYWQudmFsdWV9LmApO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21tdW5pY2F0ZXMgdGhhdCBhIGNvbmZ1c2luZyB2YWx1ZSBkaXNjb25maXJtYXRpb24gd2FzIHJlY2VpdmVkLlxuICpcbiAqIERlZmF1bHQgcmVuZGVyaW5nIChlbi1VUyk6IFwiSSdtIGNvbmZ1c2VkIHdoZXRoZXIgeW91IHdhbnQgJHt0aGlzLmNvbnRyb2wuc3RhdGUudmFsdWV9IG9yIG5vdC5cIlxuICpcbiAqIFVzYWdlOlxuICogICogVHlwaWNhbGx5IGlzc3VlZCB3aGVuIHRoZSBzeXN0ZW0gaXNzdWVkIGEgQ29uZmlybVZhbHVlQWN0IGFuZCByZWNlaXZlZCBhbiBgZGlzYWZmaXJtYCBpbiByZXBseSB3aXRoIHRoZSBtZW50aW9uZWQgdmFsdWUgcmVwZWF0ZWQuXG4gKlxuICogRXhhbXBsZTpcbiAqIGBgYFxuICogXCJBOiBEaWQgeW91IHNheSB0aHJlZT9cIiAgICAgICAgICAgICBDb25maXJtVmFsdWVBY3RcbiAqIFwiVTogTm8sIHRocmVlXCIgICAgICAgICAgICAgICAgICAgICAgQU1BWk9OX05VTUJFUl9WYWx1ZUNvbnRyb2xJbnRlbnQoIGZlZWRiYWNrID0gYWZmaXJtLCBBTUFaT04uTlVNQkVSID0gNCApXG4gKiBcIkE6IEknbSBjb25mdXNlZC4uLiA8aW5pdGlhdGl2ZT4uXCIgIFZhbHVlQ29uZmlybWVkQWN0LCA8SW5pdGlhdGl2ZUFjdD5cbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgSW5mb3JtQ29uZnVzaW5nRGlzY29uZmlybWF0aW9uQWN0PFQ+IGV4dGVuZHMgQ29udGVudEFjdCB7XG4gICAgcGF5bG9hZDogSW52YWxpZFZhbHVlUGF5bG9hZDxUPjtcbiAgICBjb25zdHJ1Y3Rvcihjb250cm9sOiBDb250cm9sLCBwYXlsb2FkOiBQcm9ibGVtYXRpY0lucHV0VmFsdWVQYXlsb2FkPFQ+KSB7XG4gICAgICAgIHN1cGVyKGNvbnRyb2wpO1xuICAgICAgICB0aGlzLnBheWxvYWQgPSBwYXlsb2FkO1xuICAgIH1cblxuICAgIHJlbmRlcihpbnB1dDogQ29udHJvbElucHV0LCBjb250cm9sUmVzcG9uc2VCdWlsZGVyOiBDb250cm9sUmVzcG9uc2VCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIGNvbnRyb2xSZXNwb25zZUJ1aWxkZXIuYWRkUHJvbXB0RnJhZ21lbnQoYEknbSBjb25mdXNlZCB3aGV0aGVyIHlvdSB3YW50ICR7dGhpcy5jb250cm9sLnN0YXRlLnZhbHVlfSBvciBub3QuYCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbW11bmljYXRlcyB0aGF0IGEgdmFsdWUgd2FzIHJlY2VpdmVkIHdoaWNoIGlzIGNvbnNpZGVyZWQgdG8gYmUgcHJvYmxlbWF0aWMuXG4gKlxuICogRGVmYXVsdCByZW5kZXJpbmcgKGVuLVVTKTogXCJJJ20gcmVhbGx5IHNvcnJ5IGJ1dCBJIGhlYXJkIHt2YWx1ZX0gYWdhaW4uXCJcbiAqXG4gKiBVc2FnZTpcbiAqICAqIFR5cGljYWxseSBpc3N1ZWQgaWYgdGhlIHVzZXIgaGFzIGFscmVhZHkgZGlzY29uZmlybWVkIHRoYXQgdmFsdWUgYnV0IHdlIGhlYXIgaXQgYWdhaW4uXG4gKlxuICogXCJVOiB0aHJlZVwiXG4gKiBcIkE6IERpZCB5b3Ugc2F5IHRocmVlP1wiXG4gKiBcIlU6IE5vXCJcbiAqIFwiQTogTXkgbWlzdGFrZSwgaG93IG1hbnkgd291bGQgeW91IGxpa2U/XCJcbiAqIFwiVTogdGhyZWVcIlxuICogXCJBOiBJJ20gcmVhbGx5IHNvcnJ5IGJ1dCBJIGhlYXJkIHRocmVlIGFnYWluLlwiXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9ibGVtYXRpY0lucHV0VmFsdWVBY3Q8VD4gZXh0ZW5kcyBDb250ZW50QWN0IHtcbiAgICBwYXlsb2FkOiBQcm9ibGVtYXRpY0lucHV0VmFsdWVQYXlsb2FkPFQ+O1xuICAgIGNvbnN0cnVjdG9yKGNvbnRyb2w6IENvbnRyb2wsIHBheWxvYWQ6IFByb2JsZW1hdGljSW5wdXRWYWx1ZVBheWxvYWQ8VD4pIHtcbiAgICAgICAgc3VwZXIoY29udHJvbCk7XG4gICAgICAgIHRoaXMucGF5bG9hZCA9IHBheWxvYWQ7XG4gICAgfVxuXG4gICAgcmVuZGVyKGlucHV0OiBDb250cm9sSW5wdXQsIGNvbnRyb2xSZXNwb25zZUJ1aWxkZXI6IENvbnRyb2xSZXNwb25zZUJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgY29udHJvbFJlc3BvbnNlQnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudChgSSdtIHJlYWxseSBzb3JyeSBidXQgSSBoZWFyZCAke3RoaXMucGF5bG9hZC52YWx1ZX0gYWdhaW4uYCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbW11bmljYXRlcyB0aGF0IHRoZSB1c2VyJ3MgaW5wdXQgY291bGQgbm90IGJlIHVuZGVyc3Rvb2QuXG4gKlxuICogRGVmYXVsdCByZW5kZXJpbmcgKGVuLVVTKTogXCJTb3JyeSBJIGRpZG4ndCB1bmRlcnN0YW5kIHRoYXQuXCJcbiAqXG4gKiBVc2FnZTpcbiAqICogVHlwaWNhbGx5IGlzc3VlZCBpbiByZXNwb25zZSB0byBBTUFaT04uRmFsbGJhY2tJbnRlbnQuXG4gKiAqIE1heSBhbHNvIGJlIGlzc3VlZCBhcyBhIGdlbmVyaWMgcmVzcG9uc2Ugd2hlbiBhbiBpbnB1dCBkb2Vzbid0IG1ha2UgYW55XG4gKiAgIHNlbnNlIGdpdmVuIHRoZSBzdGF0ZSBvZiB0aGUgc2tpbGwuXG4gKlxuICogRXhhbXBsZSAxOlxuICogXCJVOiA8Z2liYmVyaXNoPlwiICBBTUFaT04uRmFsbGJhY2tJbnRlbnRcbiAqIFwiQTogU29ycnkgSSBkaWRuJ3QgdW5kZXJzdGFuZCB0aGF0LlwiXG4gKlxuICogRXhhbXBsZSAyOlxuICogXCJVOiBjaGFuZ2UgQm9iIHRvIEZyYW5rXCIgLi4uIGJ1dCBubyBDb250cm9sIGlzIHRyYWNraW5nIGEgdmFsdWUgb2YgXCJCb2JcIlxuICogXCJBOiBTb3JyeSBJIGRpZG4ndCB1bmRlcnN0YW5kIHRoYXQuXCJcbiAqL1xuZXhwb3J0IGNsYXNzIE5vblVuZGVyc3RhbmRpbmdBY3QgZXh0ZW5kcyBDb250ZW50QWN0IHtcbiAgICBjb25zdHJ1Y3Rvcihjb250cm9sOiBDb250cm9sKSB7XG4gICAgICAgIHN1cGVyKGNvbnRyb2wpO1xuICAgIH1cblxuICAgIHJlbmRlcihpbnB1dDogQ29udHJvbElucHV0LCBjb250cm9sUmVzcG9uc2VCdWlsZGVyOiBDb250cm9sUmVzcG9uc2VCdWlsZGVyKTogdm9pZCB7XG4gICAgICAgIGNvbnRyb2xSZXNwb25zZUJ1aWxkZXIuYWRkUHJvbXB0RnJhZ21lbnQoJ1NvcnJ5IEkgZGlkblxcJ3QgdW5kZXJzdGFuZCB0aGF0LicpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21tdW5pY2F0ZXMgdGhhdCB0aGUgc2tpbGwgd2FzIGxhdW5jaGVkLlxuICpcbiAqIERlZmF1bHQgcmVuZGVyaW5nIChlbi1VUyk6IFwiV2VsY29tZS5cIlxuICovXG5leHBvcnQgY2xhc3MgTGF1bmNoQWN0IGV4dGVuZHMgQ29udGVudEFjdCB7XG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCkge1xuICAgICAgICBzdXBlcihjb250cm9sKTtcbiAgICB9XG5cbiAgICByZW5kZXIoaW5wdXQ6IENvbnRyb2xJbnB1dCwgY29udHJvbFJlc3BvbnNlQnVpbGRlcjogQ29udHJvbFJlc3BvbnNlQnVpbGRlcik6IHZvaWQge1xuICAgICAgICBjb250cm9sUmVzcG9uc2VCdWlsZGVyLmFkZFByb21wdEZyYWdtZW50KCdXZWxjb21lLicpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21tdW5pY2F0ZXMgYW4gYXJiaXRyYXJ5IG1lc3NhZ2UgdG8gdGhlIHVzZXIuXG4gKlxuICogRGVmYXVsdDpcbiAqICAqIFRoZSByZXByb21wdEZyYWdtZW50IGRlZmF1bHRzIHRvIGJlIGlkZW50aWNhbCB0byBwcm9tcHRGcmFnbWVudC5cbiAqXG4gKiBVc2FnZTpcbiAqICAqIFVzZSBMaXRlcmFsQ29udGVudEFjdCBvbmx5IGluIHNpbXBsZSBzaXR1YXRpb25zIHdoZXJlIGl0IHdvdWxkIGJlIGFubm95aW5nXG4gKiAgICB0byBjcmVhdGUgYSBuZXcgY3VzdG9tIGFjdCBvbmx5IHRvIGhhdmUgYSBzaW5nbGUgd2F5IHRvIHJlbmRlciBpdC5cbiAqICAqIEluIGNvbnRyYXN0LCBzcGVjaWZpYyBjb250ZW50IGFjdHMgY29udmV5IGluZm9ybWF0aW9uIG1vcmUgY2xlYXJseSxcbiAqICAgIG1haW50YWluIGNvbnRyb2xsZXIvdmlldyBzZXBhcmF0aW9uIGFuZCBjYW4gb2Z0ZW4gYmUgcmV1c2VkIGluIGFkZGl0aW9uYWwgc2NlbmFyaW9zLlxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIExpdGVyYWxDb250ZW50QWN0IGV4dGVuZHMgQ29udGVudEFjdCB7XG4gICAgcGF5bG9hZDogTGl0ZXJhbENvbnRlbnRQYXlsb2FkO1xuXG4gICAgY29uc3RydWN0b3IoY29udHJvbDogQ29udHJvbCwgcGF5bG9hZDogTGl0ZXJhbENvbnRlbnRQYXlsb2FkKSB7XG4gICAgICAgIHN1cGVyKGNvbnRyb2wpO1xuICAgICAgICB0aGlzLnBheWxvYWQgPSB7XG4gICAgICAgICAgICBwcm9tcHRGcmFnbWVudDogcGF5bG9hZC5wcm9tcHRGcmFnbWVudCxcbiAgICAgICAgICAgIHJlcHJvbXB0RnJhZ21lbnQ6IHBheWxvYWQucmVwcm9tcHRGcmFnbWVudCA/PyBwYXlsb2FkLnByb21wdEZyYWdtZW50XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmVuZGVyKGlucHV0OiBDb250cm9sSW5wdXQsIGNvbnRyb2xSZXNwb25zZUJ1aWxkZXI6IENvbnRyb2xSZXNwb25zZUJ1aWxkZXIpOiB2b2lkIHtcbiAgICAgICAgY29udHJvbFJlc3BvbnNlQnVpbGRlci5hZGRQcm9tcHRGcmFnbWVudCh0aGlzLnBheWxvYWQucHJvbXB0RnJhZ21lbnQpO1xuICAgICAgICBjb250cm9sUmVzcG9uc2VCdWlsZGVyLmFkZFJlcHJvbXB0RnJhZ21lbnQodGhpcy5wYXlsb2FkLnJlcHJvbXB0RnJhZ21lbnQhKTtcbiAgICB9XG59XG4iXX0=